import{u as useActiveWorkspaceId,r as reactExports,j as jsxRuntimeExports,c as clsx,B as Button,T as Trans,A as AnimatePresence,m,o as opacityAnimation,P as ProgressCircle,a as useTrans,b as useMutation,q as queryClient,t as toast,d as message,s as showHttpErrorToast,e as apiClient,f as useSettings,N as Navbar,L as Link,W as WorkspaceQueryKeys,g as onFormQueryError,h as useForm,i as useDialogContext,D as Dialog,k as DialogHeader,l as DialogBody,F as Form,n as FormTextField,p as DialogFooter,v as useQuery,w as useAuth,x as PersonalWorkspace,C as ConfirmationDialog,y as useValueLists,z as DialogTrigger,I as IconButton,E as ExitToAppIcon,G as CloseIcon,M as MenuTrigger,H as ArrowDropDownIcon,J as Menu,K as Item,O as ButtonBase,U as UnfoldMoreIcon,Q as useUserWorkspaces,R as useActiveWorkspace,S as openDialog,V as CheckIcon,X as KeyboardArrowDownIcon,Y as Skeleton,$ as $62d8ded9296f3872$export$cfa2225e87938781,Z as lazyLoader,_ as dot,a0 as StaticPageTitle,a1 as TextField,a2 as SearchIcon,a3 as Footer,a4 as FormattedRelativeTime,a5 as IllustratedMessage,a6 as SvgImage,a7 as useNavigate,a8 as SelectForwardRef,a9 as PageErrorMessage,aa as PageStatus,ab as useParams,ac as FullPageLoader,ad as Logo,ae as useRoutes,af as ActiveWorkspaceProvider,ag as Outlet,ah as NotFoundPage}from"./main-78369d74.js";import{u as useInfiniteData,b as builderImage,M as MoreVertIcon,a as useCreateProject,c as useTemplates,d as useDeleteDomain,w as world,e as useTemplate}from"./use-delete-domain-9b2df6bf.js";import{r as reloadAccountUsage,C as ChipField,A as AddIcon,D as DeleteIcon,u as useAccountUsage,g as getProjectImageUrl,K as KeyboardArrowRightIcon,P as ProjectLink,a as getProjectPreviewUrl,b as DatatableDataQueryKey,c as ConnectDomainDialog,d as removeProtocol}from"./blank-page-skeleton-9a989fe2.js";import{P as PolicyFailMessage,a as ProjectSettingsDialog,u as useCustomDomains}from"./project-settings-dialog-240e2238.js";import{G as GroupIcon,P as PersonAddIcon,K as KeyboardBackspaceIcon}from"./KeyboardBackspace-e2173281.js";import{E as EditIcon}from"./Edit-d653f744.js";import{P as PhoneIphoneIcon,D as DesktopMacIcon}from"./DesktopMac-6278c8be.js";import"./info-dialog-trigger-7dec76dd.js";function useProjects(e){const{workspaceId:s}=useActiveWorkspaceId();return useInfiniteData({queryKey:["projects",{...e,workspaceId:s}],endpoint:"projects",paginate:e.paginate||"simple",defaultOrderBy:"updated_at",defaultOrderDir:"desc",queryParams:{...e,workspaceId:s},willSortOrFilter:!0})}function InfiniteScrollSentinel({query:{isInitialLoading:e,fetchNextPage:s,isFetchingNextPage:t,hasNextPage:o},children:n,loaderMarginTop:i="mt-24",style:a,className:x,variant:u="infiniteScroll",loadMoreExtraContent:l,size:c="md"}){const d=reactExports.useRef(null),p=t||e,[E,f]=reactExports.useState(0),R=u==="loadMore"&&E<3?"loadMore":"infiniteScroll";reactExports.useEffect(()=>{const g=d.current;if(!g||R==="loadMore")return;const h=new IntersectionObserver(([v])=>{v.isIntersecting&&o&&!p&&s()});return h.observe(g),()=>{h.unobserve(g)}},[s,o,p,R]);let j;return n?j=t?n:null:R==="loadMore"?j=!e&&o&&jsxRuntimeExports.jsxs("div",{className:clsx("flex items-center gap-8",i),children:[l,jsxRuntimeExports.jsx(Button,{size:c==="md"?"sm":"xs",className:clsx(c==="sm"?"min-h-24 min-w-96":"min-h-36 min-w-112"),variant:"outline",color:"primary",onClick:()=>{s(),f(E+1)},disabled:p,children:E>=2&&!t?jsxRuntimeExports.jsx(Trans,{message:"Load all"}):jsxRuntimeExports.jsx(Trans,{message:"Show more"})})]}):j=jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsx(m.div,{className:clsx("flex w-full justify-center",i),...opacityAnimation,children:jsxRuntimeExports.jsx(ProgressCircle,{size:c,isIndeterminate:!0,"aria-label":"loading"})})}),jsxRuntimeExports.jsxs("div",{style:a,className:clsx("w-full",x,o&&"min-h-36"),role:"presentation",children:[jsxRuntimeExports.jsx("div",{ref:d,"aria-hidden":!0}),j]})}function useDeleteProject(){const{trans:e}=useTrans();return useMutation({mutationFn:s=>deleteProject(s),onSuccess:async()=>{reloadAccountUsage(),await queryClient.invalidateQueries({queryKey:["projects"]}),toast(e(message("Project deleted")))},onError:s=>showHttpErrorToast(s)})}async function deleteProject({projectId:e}){return apiClient.delete(`projects/${e}`).then(s=>s.data)}function DashboardNavbar(){const{billing:e}=useSettings();return jsxRuntimeExports.jsx(Navbar,{menuPosition:"dashboard",className:"flex-shrink-0",rightChildren:e.enable?jsxRuntimeExports.jsx(Button,{variant:"outline",size:"xs",color:"primary",elementType:Link,to:"/pricing",children:jsxRuntimeExports.jsx(Trans,{message:"Upgrade"})}):void 0})}function useCreateWorkspace(e){return useMutation({mutationFn:s=>createWorkspace(s),onSuccess:()=>{toast(message("Created workspace")),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.fetchUserWorkspaces})},onError:s=>onFormQueryError(s,e)})}function createWorkspace(e){return apiClient.post("workspace",e).then(s=>s.data)}function NewWorkspaceDialog(){const e=useForm(),{formId:s,close:t}=useDialogContext(),o=useCreateWorkspace(e);return jsxRuntimeExports.jsxs(Dialog,{children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Create workspace"})}),jsxRuntimeExports.jsx(DialogBody,{children:jsxRuntimeExports.jsx(Form,{form:e,id:s,onSubmit:()=>{o.mutate(e.getValues(),{onSuccess:n=>{t(n.workspace.id)}})},children:jsxRuntimeExports.jsx(FormTextField,{name:"name",autoFocus:!0,label:jsxRuntimeExports.jsx(Trans,{message:"Workspace name"}),minLength:3,required:!0})})}),jsxRuntimeExports.jsxs(DialogFooter,{children:[jsxRuntimeExports.jsx(Button,{variant:"text",onClick:t,children:jsxRuntimeExports.jsx(Trans,{message:"Cancel"})}),jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",type:"submit",form:s,disabled:o.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Create"})})]})]})}function fetchWorkspaceWithMembers(e){return apiClient.get(`workspace/${e}`).then(s=>s.data)}function useWorkspaceWithMembers(e){return useQuery({queryKey:WorkspaceQueryKeys.workspaceWithMembers(e),queryFn:()=>fetchWorkspaceWithMembers(e)})}function InviteMembers({workspaceId:e,...s}){return apiClient.post(`workspace/${e}/invite`,s).then(t=>t.data)}function useInviteMembers(){return useMutation({mutationFn:e=>InviteMembers(e),onSuccess:(e,s)=>{queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(s.workspaceId)})},onError:e=>showHttpErrorToast(e)})}function ResendInvite({workspaceId:e,inviteId:s,...t}){return apiClient.post(`workspace/${e}/${s}/resend`,t).then(o=>o.data)}function useResendInvite(){return useMutation({mutationFn:e=>ResendInvite(e),onSuccess:()=>{toast("Invite sent")},onError:e=>showHttpErrorToast(e)})}const matcher=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function isEmail(e){return!e||e.length>320?!1:matcher.test(e)}function ChangeRole({workspaceId:e,member:s,...t}){const o=s.model_type,n=s.model_type==="invite"?s.id:s.member_id;return apiClient.post(`workspace/${e}/${o}/${n}/change-role`,t).then(i=>i.data)}function useChangeRole(){return useMutation({mutationFn:e=>ChangeRole(e),onSuccess:(e,s)=>{toast(message("Role changed")),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(s.workspaceId)})},onError:e=>showHttpErrorToast(e)})}function removeMember({workspaceId:e,memberId:s,memberType:t}){const o=t==="invite"?`workspace/invite/${s}`:`workspace/${e}/member/${s}`;return apiClient.delete(o).then(n=>n.data)}function useRemoveMember(){const{workspaceId:e,setWorkspaceId:s}=useActiveWorkspaceId(),{user:t}=useAuth();return useMutation({mutationFn:o=>removeMember(o),onSuccess:(o,n)=>{queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.fetchUserWorkspaces}),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(n.workspaceId)}),n.memberId===(t==null?void 0:t.id)&&e===n.workspaceId&&s(PersonalWorkspace.id)},onError:o=>showHttpErrorToast(o)})}function LeaveWorkspaceConfirmation({onConfirm:e,isLoading:s}){return jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Leave workspace"}),isLoading:s,onConfirm:e,body:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to leave this workspace?"}),jsxRuntimeExports.jsx("div",{className:"mt-8 font-semibold",children:jsxRuntimeExports.jsx(Trans,{message:"All resources you've created in the workspace will be transferred to workspace owner."})})]}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Leave"})})}function WorkspaceMembersDialog({workspace:e}){const{data:s,isLoading:t}=useWorkspaceWithMembers(e.id);return jsxRuntimeExports.jsxs(Dialog,{size:"lg",children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Manage workspace members"})}),jsxRuntimeExports.jsx(DialogBody,{children:t?jsxRuntimeExports.jsx("div",{className:"flex min-h-[238px] items-center justify-center",children:jsxRuntimeExports.jsx(ProgressCircle,{isIndeterminate:!0,"aria-label":"Loading workspace..."})}):jsxRuntimeExports.jsx(Manager,{workspace:s.workspace})})]})}function Manager({workspace:e}){const{user:s}=useAuth(),t=usePermissions(e),o=[...e.members||[],...e.invites||[]],n=!t.update&&!t.delete;return jsxRuntimeExports.jsxs("div",{children:[t.invite&&jsxRuntimeExports.jsx(InviteChipField,{workspace:e}),jsxRuntimeExports.jsxs("div",{className:"mb-14 flex items-center gap-10 text-base",children:[jsxRuntimeExports.jsx(GroupIcon,{className:"icon-sm"}),jsxRuntimeExports.jsx(Trans,{message:"Members of `:workspace`",values:{workspace:e.name}})]}),jsxRuntimeExports.jsxs(AnimatePresence,{initial:!1,children:[o.map(i=>n&&i.id!==(s==null?void 0:s.id)?null:jsxRuntimeExports.jsx(MemberListItem,{workspace:e,member:i},`${i.model_type}.${i.id}`)),n&&jsxRuntimeExports.jsx("div",{className:"text-muted",children:jsxRuntimeExports.jsx(Trans,{message:"And [one one other member|:count other members]",values:{count:o.length}})})]})]})}function MemberListItem({workspace:e,member:s}){return jsxRuntimeExports.jsxs(m.div,{initial:{x:"-100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"100%",opacity:0},transition:{type:"tween",duration:.125},className:"mb-20 flex items-start gap-14 text-sm",children:[jsxRuntimeExports.jsx("img",{className:"h-36 w-36 flex-shrink-0 rounded",src:s.avatar,alt:""}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-auto items-center justify-between gap-14 md:flex",children:[jsxRuntimeExports.jsxs("div",{className:"mb-10 overflow-hidden md:mb-0 md:mr-10",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-start gap-6",children:[jsxRuntimeExports.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:s.display_name}),jsxRuntimeExports.jsx(MemberDisplayNameAppend,{workspace:e,member:s})]}),jsxRuntimeExports.jsx("div",{className:"text-muted",children:s.email})]}),jsxRuntimeExports.jsx(MemberActions,{workspace:e,member:s})]})]},`${s.model_type}.${s.id}`)}function usePermissions(e){var i;const{user:s}=useAuth(),t={update:!1,invite:!1,delete:!1},o=["update","invite","delete"],n=(i=e.members)==null?void 0:i.find(a=>a.id===(s==null?void 0:s.id));return n&&o.forEach(a=>{var x;t[a]=n.is_owner||!!((x=n.permissions)!=null&&x.find(u=>u.name===`workspace_members.${a}`))}),t}function MemberActions({workspace:e,member:s}){const[t,o]=reactExports.useState(s.role_id),n=useChangeRole(),{user:i}=useAuth(),a=usePermissions(e),x=s.model_type==="member"&&s.is_owner,u=s.model_type==="member"&&(i==null?void 0:i.id)===s.id,l=!a.update||x||u?jsxRuntimeExports.jsx("div",{className:"ml-auto text-muted first:capitalize",children:jsxRuntimeExports.jsx(Trans,{message:s.role_name})}):jsxRuntimeExports.jsx(RoleMenuTrigger,{className:"ml-auto flex-shrink-0",size:"xs",value:t,isDisabled:n.isPending,onChange:c=>{o(c),n.mutate({roleId:c,workspaceId:e.id,member:s})}});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[l,!x&&(u||a.delete)&&jsxRuntimeExports.jsx(RemoveMemberButton,{type:u?"leave":"remove",member:s,workspace:e})]})}function InviteChipField({workspace:e}){const{trans:s}=useTrans(),[t,o]=reactExports.useState([]),n=t.every(c=>!c.invalid),i=c=>c.description||c.name,[a,x]=reactExports.useState(),u=useInviteMembers(),{data:l}=useValueLists(["workspaceRoles"]);return reactExports.useEffect(()=>{var c;!a&&((c=l==null?void 0:l.workspaceRoles)!=null&&c.length)&&x(l.workspaceRoles[0].id)},[l,a]),jsxRuntimeExports.jsxs("div",{className:"mb-30",children:[jsxRuntimeExports.jsx(ChipField,{value:t,onChange:o,displayWith:i,validateWith:c=>{const d=!isEmail(c.description);return{...c,invalid:d,errorMessage:d?s({message:"Not a valid email"}):void 0}},placeholder:s({message:"Enter email addresses"}),label:jsxRuntimeExports.jsx(Trans,{message:"Invite people"})}),jsxRuntimeExports.jsxs("div",{className:"mt-14 flex items-center justify-between gap-14",children:[jsxRuntimeExports.jsx(RoleMenuTrigger,{onChange:x,value:a}),t.length&&a?jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",size:"sm",disabled:u.isPending||!n,onClick:()=>{u.mutate({emails:t.map(c=>i(c)),roleId:a,workspaceId:e.id},{onSuccess:()=>{o([])}})},children:jsxRuntimeExports.jsx(Trans,{message:"Invite"})}):null]})]})}function RemoveMemberButton({member:e,workspace:s,type:t}){const o=useRemoveMember(),{close:n}=useDialogContext();return jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:i=>{i&&(o.mutate({workspaceId:s.id,memberId:e.id,memberType:e.model_type}),t==="leave"&&(n(),toast(message("Left workspace"))))},children:[jsxRuntimeExports.jsx(IconButton,{size:"md",className:"flex-shrink-0 text-muted",disabled:o.isPending,children:t==="leave"?jsxRuntimeExports.jsx(ExitToAppIcon,{}):jsxRuntimeExports.jsx(CloseIcon,{})}),t==="leave"?jsxRuntimeExports.jsx(LeaveWorkspaceConfirmation,{}):jsxRuntimeExports.jsx(RemoveMemberConfirmation,{member:e})]})}function RemoveMemberConfirmation({member:e}){return jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Remove member"}),body:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to remove `:name`?",values:{name:e.display_name}}),jsxRuntimeExports.jsx("div",{className:"mt-8 font-semibold",children:jsxRuntimeExports.jsx(Trans,{message:"All workspace resources created by `:name` will be transferred to workspace owner.",values:{name:e.display_name}})})]}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Remove"})})}function RoleMenuTrigger({value:e,onChange:s,size:t="xs",className:o,isDisabled:n}){var x;const{data:i}=useValueLists(["workspaceRoles"]),a=(x=i==null?void 0:i.workspaceRoles)==null?void 0:x.find(u=>u.id===e);return!e||!a||!(i!=null&&i.workspaceRoles)?null:jsxRuntimeExports.jsxs(MenuTrigger,{selectionMode:"single",selectedValue:e,onSelectionChange:u=>{s(u)},children:[jsxRuntimeExports.jsx(Button,{className:o,size:t,variant:"flat",color:"chip",disabled:n,endIcon:jsxRuntimeExports.jsx(ArrowDropDownIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:a.name})}),jsxRuntimeExports.jsx(Menu,{children:i.workspaceRoles.map(u=>jsxRuntimeExports.jsx(Item,{value:u.id,description:u.description,children:jsxRuntimeExports.jsx(Trans,{message:u.name})},u.id))})]})}function MemberDisplayNameAppend({member:e,workspace:s}){const{user:t}=useAuth(),o=usePermissions(s);return(t==null?void 0:t.id)===e.id?jsxRuntimeExports.jsxs("div",{className:"font-medium",children:["(",jsxRuntimeExports.jsx(Trans,{message:"You"}),")"]}):e.model_type==="invite"?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{children:"·"}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:jsxRuntimeExports.jsx(Trans,{message:"Invited"})}),o.invite?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:"·"}),jsxRuntimeExports.jsx(ResendInviteDialogTrigger,{member:e,workspace:s})]}):null]}):null}function ResendInviteDialogTrigger({member:e,workspace:s}){const t=useResendInvite();return jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:o=>{o&&t.mutate({workspaceId:s.id,inviteId:e.id})},children:[jsxRuntimeExports.jsx(Button,{variant:"link",size:"sm",color:"primary",disabled:t.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Resend invite"})}),jsxRuntimeExports.jsx(ConfirmationDialog,{title:jsxRuntimeExports.jsx(Trans,{message:"Resend invite"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to send this invite again?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Send"})})]})}function updateWorkspace({id:e,...s}){return apiClient.put(`workspace/${e}`,s).then(t=>t.data)}function useUpdateWorkspace(e){const{close:s}=useDialogContext();return useMutation({mutationFn:t=>updateWorkspace(t),onSuccess:t=>{s(),toast(message("Updated workspace")),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.fetchUserWorkspaces}),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(t.workspace.id)})},onError:t=>onFormQueryError(t,e)})}function RenameWorkspaceDialog({workspace:e}){const s=useForm({defaultValues:{id:e.id,name:e.name}}),{formId:t,close:o}=useDialogContext(),n=useUpdateWorkspace(s);return jsxRuntimeExports.jsxs(Dialog,{children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Rename workspace"})}),jsxRuntimeExports.jsx(DialogBody,{children:jsxRuntimeExports.jsx(Form,{form:s,id:t,onSubmit:()=>{n.mutate(s.getValues())},children:jsxRuntimeExports.jsx(FormTextField,{name:"name",autoFocus:!0,label:jsxRuntimeExports.jsx(Trans,{message:"Name"}),minLength:3,required:!0})})}),jsxRuntimeExports.jsxs(DialogFooter,{children:[jsxRuntimeExports.jsx(Button,{variant:"text",onClick:o,children:jsxRuntimeExports.jsx(Trans,{message:"Cancel"})}),jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",type:"submit",form:t,disabled:n.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Rename"})})]})]})}function deleteWorkspace({id:e}){return apiClient.delete(`workspace/${e}`).then(s=>s.data)}function useDeleteWorkspace(){const{workspaceId:e,setWorkspaceId:s}=useActiveWorkspaceId();return useMutation({mutationFn:t=>deleteWorkspace(t),onSuccess:(t,o)=>{toast(message("Deleted workspace")),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.fetchUserWorkspaces}),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(o.id)}),e===o.id&&s(PersonalWorkspace.id)},onError:t=>showHttpErrorToast(t)})}function WorkspaceSelector({onChange:e,className:s,trigger:t,placement:o="top"}){const{data:n,isFetched:i,isFetching:a}=useUserWorkspaces(),{setWorkspaceId:x}=useActiveWorkspaceId(),u=useActiveWorkspace(),[l,c]=reactExports.useState(!1),{hasPermission:d}=useAuth();return reactExports.useEffect(()=>{i&&!a&&!u&&x(PersonalWorkspace.id)},[u,n,x,i,a]),!t&&(!u||!d("workspaces.create")&&(n==null?void 0:n.length)===1)?null:jsxRuntimeExports.jsx(reactExports.Fragment,{children:jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",placement:o,isOpen:l,onClose:()=>{c(!1)},children:[t?reactExports.cloneElement(t,{onClick:()=>c(!l)}):jsxRuntimeExports.jsx(DefaultTrigger,{onClick:()=>c(!l),workspace:u,className:s}),jsxRuntimeExports.jsx(Dialog,{size:"min-w-320",children:jsxRuntimeExports.jsxs(DialogBody,{padding:"p-10",children:[jsxRuntimeExports.jsx("div",{className:"mb-16 border-b pb-10",children:n==null?void 0:n.map(p=>jsxRuntimeExports.jsx(WorkspaceItem,{workspace:p,setSelectorIsOpen:c,onChange:e},p.id))}),jsxRuntimeExports.jsx("div",{className:"mb-4 px-4 text-center",children:jsxRuntimeExports.jsx(CreateWorkspaceButton,{onClick:()=>c(!1),onCreated:p=>e==null?void 0:e(p),workspaceCount:n?n.length-1:0})})]})})]})})}function CreateWorkspaceButton({onClick:e,onCreated:s,workspaceCount:t}){const{setWorkspaceId:o}=useActiveWorkspaceId(),{checkOverQuotaOrNoPermission:n}=useAuth(),{overQuotaOrNoPermission:i}=n("workspaces.create","count",t);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{disabled:i,onClick:async a=>{a.preventDefault(),a.stopPropagation(),e();const x=await openDialog(NewWorkspaceDialog);x&&(o(x),s==null||s(x))},variant:"outline",startIcon:jsxRuntimeExports.jsx(AddIcon,{}),color:"primary",className:"h-40 w-full",children:jsxRuntimeExports.jsx(Trans,{message:"Create new workspace"})}),i&&jsxRuntimeExports.jsx(PolicyFailMessage,{size:"sm",className:"mt-12 max-w-288",resourceName:jsxRuntimeExports.jsx(Trans,{message:"worksapces"})})]})}const DefaultTrigger=reactExports.forwardRef(({workspace:e,className:s,onClick:t,...o},n)=>jsxRuntimeExports.jsxs(ButtonBase,{ref:n,onClick:t,className:clsx("flex items-center gap-10 rounded ring-inset hover:bg-hover focus-visible:ring-2",s),...o,children:[jsxRuntimeExports.jsxs("span",{className:"mr-auto block flex-auto overflow-hidden text-left",children:[jsxRuntimeExports.jsx("span",{className:"block overflow-hidden overflow-ellipsis text-sm font-medium text-main",children:e.default?jsxRuntimeExports.jsx(Trans,{message:e.name}):e.name}),jsxRuntimeExports.jsx("span",{className:"block text-xs text-muted",children:e.default?jsxRuntimeExports.jsx(Trans,{message:"Personal workspace"}):jsxRuntimeExports.jsx(Trans,{message:":count members",values:{count:e.members_count}})})]}),jsxRuntimeExports.jsx(UnfoldMoreIcon,{className:"shrink-0 icon-md"})]}));function WorkspaceItem({workspace:e,onChange:s,setSelectorIsOpen:t}){const{workspaceId:o,setWorkspaceId:n}=useActiveWorkspaceId(),i=o===e.id;return jsxRuntimeExports.jsxs("div",{onClick:()=>{n(e.id),s==null||s(e.id),t(!1)},className:clsx("mb-4 flex cursor-pointer items-center gap-12 rounded-lg p-10 text-left",i&&"bg-primary/5",!i&&"hover:bg-hover"),children:[jsxRuntimeExports.jsx(CheckIcon,{size:"sm",className:clsx("flex-shrink-0 text-primary",!i&&"invisible")}),jsxRuntimeExports.jsxs("div",{className:"flex-auto",children:[jsxRuntimeExports.jsx("div",{className:clsx("text-sm",i&&"font-semibold"),children:e.name}),jsxRuntimeExports.jsx("div",{className:"text-sm text-muted",children:e.default?jsxRuntimeExports.jsx(Trans,{message:"Personal workspace"}):jsxRuntimeExports.jsx(Trans,{message:":count members",values:{count:e.members_count}})})]}),e.id!==0&&jsxRuntimeExports.jsx(ManageButton,{setSelectorIsOpen:t,workspace:e,onChange:s})]})}function LeaveWorkspaceDialog({workspace:e,onChange:s}){const t=useRemoveMember(),{user:o}=useAuth(),{close:n}=useDialogContext();return jsxRuntimeExports.jsx(LeaveWorkspaceConfirmation,{isLoading:t.isPending,onConfirm:()=>{t.mutate({workspaceId:e.id,memberId:o.id,memberType:"member"},{onSuccess:()=>{n(),s==null||s(PersonalWorkspace.id)}})}})}function DeleteWorkspaceConfirmation({workspace:e,onChange:s}){const t=useDeleteWorkspace(),{close:o}=useDialogContext();return jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Delete workspace"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to delete “:name“?",values:{name:e.name}}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Delete"}),isLoading:t.isPending,onConfirm:()=>{t.mutate({id:e.id},{onSuccess:()=>{o(),s==null||s(PersonalWorkspace.id)}})}})}function ManageButton({setSelectorIsOpen:e,workspace:s,onChange:t}){const{user:o}=useAuth();return jsxRuntimeExports.jsxs(MenuTrigger,{onItemSelected:()=>e(!1),children:[jsxRuntimeExports.jsx(Button,{onClick:n=>{n.preventDefault(),n.stopPropagation()},color:"primary",size:"xs",variant:"outline",endIcon:jsxRuntimeExports.jsx(KeyboardArrowDownIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Manage"})}),jsxRuntimeExports.jsxs(Menu,{children:[jsxRuntimeExports.jsx(Item,{onClick:n=>{n.stopPropagation(),openDialog(WorkspaceMembersDialog,{workspace:s})},value:"workspaceMembers",startIcon:jsxRuntimeExports.jsx(PersonAddIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Members"})}),s.owner_id===(o==null?void 0:o.id)&&jsxRuntimeExports.jsx(Item,{onClick:n=>{n.stopPropagation(),openDialog(RenameWorkspaceDialog,{workspace:s})},value:"updateWorkspace",startIcon:jsxRuntimeExports.jsx(EditIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Rename"})}),s.owner_id!==(o==null?void 0:o.id)&&jsxRuntimeExports.jsx(Item,{onClick:n=>{n.stopPropagation(),openDialog(LeaveWorkspaceDialog,{workspace:s,onChange:t})},value:"leaveWorkspace",startIcon:jsxRuntimeExports.jsx(ExitToAppIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Leave"})}),s.owner_id===(o==null?void 0:o.id)&&jsxRuntimeExports.jsx(Item,{onClick:n=>{n.stopPropagation(),openDialog(DeleteWorkspaceConfirmation,{workspace:s,onChange:t})},value:"deleteWorkspace",startIcon:jsxRuntimeExports.jsx(DeleteIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Delete"})})]})]})}function DashboardWorkspaceSelector({className:e}){const s=useActiveWorkspace();return jsxRuntimeExports.jsx("div",{className:e,children:jsxRuntimeExports.jsx(WorkspaceSelector,{onChange:()=>reloadAccountUsage(),placement:"bottom",trigger:jsxRuntimeExports.jsx(Button,{variant:"outline",className:"min-w-[188px]",justify:"justify-between",endIcon:jsxRuntimeExports.jsx(UnfoldMoreIcon,{}),children:jsxRuntimeExports.jsx(Label,{workspace:s})})})})}function Label({workspace:e}){return e?e.default?jsxRuntimeExports.jsx(Trans,{message:"Default workspace"}):e.name:jsxRuntimeExports.jsx(Skeleton,{})}function AdHost({slot:e,className:s}){var i;const t=useSettings(),{isSubscribed:o}=useAuth(),n=reactExports.useMemo(()=>dot.pick(`ads.${e}`,t),[e,t]);return(i=t.ads)!=null&&i.disable||o||!n?null:jsxRuntimeExports.jsx(InvariantAd,{className:s,slot:e,adCode:n})}const InvariantAd=reactExports.memo(({slot:e,adCode:s,className:t})=>{const o=reactExports.useRef(null),n=reactExports.useId();return reactExports.useEffect(()=>(o.current&&loadAdScripts(s,o.current).then(()=>{executeAdJavascript(s,n)}),()=>{delete window.google_ad_modifications}),[s,n]),reactExports.useEffect(()=>{if(o.current){const i=$62d8ded9296f3872$export$cfa2225e87938781(o.current);if(i){const a=new MutationObserver(function(){i.style.height="",i.style.minHeight=""});return a.observe(i,{attributes:!0,attributeFilter:["style"]}),()=>a.disconnect()}}},[]),jsxRuntimeExports.jsx("div",{ref:o,id:n,className:clsx("ad-host flex max-h-[600px] min-h-90 w-full max-w-full items-center justify-center overflow-hidden",`${e.replace(/\./g,"-")}-host`,t),dangerouslySetInnerHTML:{__html:getAdHtml(s)}})},()=>!1);function getAdHtml(e){return e==null?void 0:e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").trim()}function loadAdScripts(e,s){const t=[],o=/<script.*?src=['"](.*?)['"]/g;let n;for(;n=o.exec(e);)n[1]&&t.push(lazyLoader.loadAsset(n[1],{type:"js",parentEl:s}));return Promise.all(t)}function executeAdJavascript(adCode,id){const pattern=/<script\b[^>]*>([\s\S]*?)<\/script>/g;let content;for(;content=pattern.exec(adCode);)if(content[1]){const r=`var d = document.createElement('div'); d.innerHTML = $1; document.getElementById('${id}').appendChild(d.firstChild);`,toEval=content[1].replace(/document.write\((.+?)\);/,r);eval(toEval)}}const SortOptions=[{value:"created_at|desc",label:message("Date created")},{value:"name|asc",label:message("Alphabetical")},{value:"updated_at|desc",label:message("Last updated")}];function DashboardPage(){const{data:e}=useAccountUsage(),{trans:s}=useTrans(),{user:t}=useAuth(),o=useProjects({userId:t.id,paginate:"lengthAware"}),{sortDescriptor:n,setSortDescriptor:i,searchQuery:a,setSearchQuery:x}=o,u=`${n.orderBy}|${n.orderDir}`;return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Dashboard"})}),jsxRuntimeExports.jsxs("div",{className:"flex h-screen flex-col overflow-y-scroll",children:[jsxRuntimeExports.jsx(DashboardNavbar,{}),jsxRuntimeExports.jsxs("div",{className:"container mx-auto flex-auto px-12",children:[(e==null?void 0:e.projects.create.allowed)===!1&&jsxRuntimeExports.jsx(PolicyFailMessage,{className:"mt-24 text-center",resourceName:jsxRuntimeExports.jsx(Trans,{message:"sites"})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-12 py-36",children:[jsxRuntimeExports.jsx(DashboardWorkspaceSelector,{className:"mr-auto"}),jsxRuntimeExports.jsx(TextField,{size:"sm",placeholder:s(message("Search sites...")),startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),value:a,onChange:l=>x(l.target.value)}),jsxRuntimeExports.jsxs(MenuTrigger,{selectionMode:"single",selectedValue:u,onItemSelected:l=>{const[c,d]=l.split("|");i({orderBy:c,orderDir:d})},children:[jsxRuntimeExports.jsx(Button,{size:"sm",variant:"outline",endIcon:jsxRuntimeExports.jsx(KeyboardArrowDownIcon,{}),children:jsxRuntimeExports.jsx(Trans,{...SortOptions.find(l=>l.value===u).label})}),jsxRuntimeExports.jsx(Menu,{children:SortOptions.map(l=>jsxRuntimeExports.jsx(Item,{value:l.value,children:jsxRuntimeExports.jsx(Trans,{...l.label})},l.value))})]}),jsxRuntimeExports.jsx(Button,{size:"sm",variant:"flat",color:"primary",elementType:Link,to:"templates",startIcon:jsxRuntimeExports.jsx(AddIcon,{}),disabled:!(e!=null&&e.projects.create.allowed),children:jsxRuntimeExports.jsx(Trans,{message:"New site"})})]}),jsxRuntimeExports.jsx(AdHost,{slot:"dashboard_top",className:"mb-36"}),jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,mode:"wait",children:jsxRuntimeExports.jsx(ProjectGrid,{query:o})}),jsxRuntimeExports.jsx(AdHost,{slot:"dashboard_bottom",className:"mt-36"})]}),jsxRuntimeExports.jsx(Footer,{className:"mt-40 px-40"})]})]})}function ProjectGrid({query:e}){return e.data?e.noResults?jsxRuntimeExports.jsx(NoProjectsMessage,{isSearching:!!e.searchQuery}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(GridLayout,{animationKey:"projects",children:e.items.map(s=>jsxRuntimeExports.jsxs("div",{className:"rounded-panel border shadow",children:[jsxRuntimeExports.jsxs("div",{className:"group relative",children:[jsxRuntimeExports.jsx("img",{className:"aspect-video w-full",src:getProjectImageUrl(s),alt:""}),jsxRuntimeExports.jsx("div",{className:"absolute left-0 top-0 hidden h-full w-full items-center justify-center bg-white/70 group-hover:flex",children:jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",endIcon:jsxRuntimeExports.jsx(KeyboardArrowRightIcon,{}),elementType:Link,to:`/editor/${s.id}`,children:jsxRuntimeExports.jsx(Trans,{message:"Open editor"})})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-6 p-20",children:[jsxRuntimeExports.jsxs("div",{className:"flex-auto",children:[jsxRuntimeExports.jsx("div",{className:"font-bold",children:s.name}),jsxRuntimeExports.jsx("div",{className:"text-sm text-muted",children:jsxRuntimeExports.jsx(ProjectLink,{project:s})}),jsxRuntimeExports.jsx("div",{className:"mt-4 text-xs text-muted",children:jsxRuntimeExports.jsx(FormattedRelativeTime,{date:s.updated_at})})]}),jsxRuntimeExports.jsx(OptionsTrigger,{project:s})]})]},s.id))}),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:e})]}):e.isLoading?jsxRuntimeExports.jsx(GridLayout,{animationKey:"skeletons",children:[...Array(6)].map((s,t)=>jsxRuntimeExports.jsx(Skeleton,{variant:"rect",size:"h-[310px]"},t))}):null}function GridLayout({children:e,animationKey:s}){return jsxRuntimeExports.jsx(m.div,{...opacityAnimation,className:"grid grid-cols-1 gap-12 md:grid-cols-3",children:e},s)}function NoProjectsMessage({isSearching:e}){return jsxRuntimeExports.jsx(IllustratedMessage,{className:"mt-40",title:jsxRuntimeExports.jsx(Trans,{message:"No sites"}),description:e?jsxRuntimeExports.jsx(Trans,{message:"No sites match your search query"}):jsxRuntimeExports.jsx(Trans,{message:"You have not created any sites yet"}),image:jsxRuntimeExports.jsx(SvgImage,{src:builderImage})})}function OptionsTrigger({project:e}){const[s,t]=reactExports.useState(!1);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsxs(MenuTrigger,{children:[jsxRuntimeExports.jsx(IconButton,{className:"text-muted",children:jsxRuntimeExports.jsx(MoreVertIcon,{})}),jsxRuntimeExports.jsxs(Menu,{children:[jsxRuntimeExports.jsx(Item,{value:"edit",elementType:Link,to:`/editor/${e.id}`,children:jsxRuntimeExports.jsx(Trans,{message:"Edit"})}),jsxRuntimeExports.jsx(Item,{value:"preview",elementType:Link,target:"_blank",to:getProjectPreviewUrl(e),children:jsxRuntimeExports.jsx(Trans,{message:"Preview"})}),jsxRuntimeExports.jsx(Item,{value:"settings",onSelected:()=>openDialog(ProjectSettingsDialog,{project:e}),children:jsxRuntimeExports.jsx(Trans,{message:"Settings"})}),jsxRuntimeExports.jsx(Item,{value:"delete",onSelected:()=>t(!0),children:jsxRuntimeExports.jsx(Trans,{message:"Delete"})})]})]}),jsxRuntimeExports.jsx(DeleteProjectDialog,{isOpen:s,onClose:()=>t(!1),projectId:e.id})]})}function DeleteProjectDialog({projectId:e,isOpen:s,onClose:t}){const o=useDeleteProject();return jsxRuntimeExports.jsx(DialogTrigger,{type:"modal",isOpen:s,onClose:t,children:jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Delete project"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to delete this project?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Delete"}),isLoading:o.isPending,onConfirm:()=>{o.mutate({projectId:e},{onSuccess:()=>{t()}})}})})}function TemplateGridLayout({className:e,children:s,animationKey:t}){return jsxRuntimeExports.jsx(m.div,{className:clsx("grid grid-cols-1 gap-20 md:grid-cols-3",e),...opacityAnimation,children:s},t)}const TemplateGridItemLayout=reactExports.forwardRef(({children:e,label:s,className:t},o)=>jsxRuntimeExports.jsxs("div",{ref:o,className:clsx("overflow-hidden rounded-panel border border-transparent shadow-md",t),children:[e,jsxRuntimeExports.jsx("div",{className:"mt-4 flex items-center justify-center p-12 text-sm font-semibold capitalize",children:s})]}));function TemplateGridSkeletons(){return jsxRuntimeExports.jsx(reactExports.Fragment,{children:[...Array(9)].map((e,s)=>jsxRuntimeExports.jsx(TemplateGridItemLayout,{label:jsxRuntimeExports.jsx(Skeleton,{}),children:jsxRuntimeExports.jsx(Skeleton,{variant:"rect",size:"aspect-[365/228]"})},s))})}function NewProjectDialog({templateName:e}){const{formId:s,close:t}=useDialogContext(),o=useNavigate(),n=useForm({defaultValues:{templateName:e}}),i=useCreateProject(n);return jsxRuntimeExports.jsxs(Dialog,{children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Create new site"})}),jsxRuntimeExports.jsx(DialogBody,{children:jsxRuntimeExports.jsx(Form,{form:n,id:s,onSubmit:a=>i.mutate(a,{onSuccess:x=>{t(),o(`/editor/${x.project.model.id}`,{replace:!0})}}),children:jsxRuntimeExports.jsx(FormTextField,{name:"name",label:jsxRuntimeExports.jsx(Trans,{message:"Name"}),autoFocus:!0,required:!0})})}),jsxRuntimeExports.jsxs(DialogFooter,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>t(),children:jsxRuntimeExports.jsx(Trans,{message:"Cancel"})}),jsxRuntimeExports.jsx(Button,{form:s,type:"submit",variant:"flat",color:"primary",disabled:i.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Create"})})]})]})}function NewProjectPage(){return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"New site"})}),jsxRuntimeExports.jsx(DashboardNavbar,{}),jsxRuntimeExports.jsxs("div",{className:"container mx-auto mt-40 px-20",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-medium",children:jsxRuntimeExports.jsx(Trans,{message:"Choose a template for your project"})}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-muted",children:jsxRuntimeExports.jsx(Trans,{message:"All templates are 100% customizable so choose one then make it your own."})})]}),jsxRuntimeExports.jsx(TemplateForm,{}),jsxRuntimeExports.jsx(Footer,{})]})]})}function TemplateForm(){var i;const{trans:e}=useTrans(),{builder:s}=useSettings(),[t,o]=reactExports.useState(""),n=useTemplates({category:t,perPage:24});return jsxRuntimeExports.jsxs("div",{className:"mt-20 md:mt-40",children:[jsxRuntimeExports.jsxs("section",{className:"items-center justify-between gap-12 md:flex",children:[jsxRuntimeExports.jsxs("div",{className:"flex-auto items-center gap-12 md:flex",children:[jsxRuntimeExports.jsx(TextField,{placeholder:e(message("Search...")),startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),className:"min-w-288 max-md:mb-12",value:n.searchQuery,onChange:a=>n.setSearchQuery(a.target.value),endAdornment:n.isReloading&&n.searchQuery&&jsxRuntimeExports.jsx(ProgressCircle,{isIndeterminate:!0,size:"xs"})}),jsxRuntimeExports.jsxs(SelectForwardRef,{selectionMode:"single",name:"category",className:"min-w-288 max-md:mb-12",floatingWidth:"matchTrigger",selectedValue:t,onItemSelected:a=>o(a),children:[jsxRuntimeExports.jsx(Item,{value:"",children:jsxRuntimeExports.jsx(Trans,{message:"All categories"})}),(i=s==null?void 0:s.template_categories)==null?void 0:i.map(a=>jsxRuntimeExports.jsx(Item,{value:a,children:jsxRuntimeExports.jsx(Trans,{message:a})},a))]})]}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",className:"min-h-42",children:jsxRuntimeExports.jsx(Trans,{message:"Start with blank page"})}),jsxRuntimeExports.jsx(NewProjectDialog,{})]})]}),jsxRuntimeExports.jsxs("div",{className:"my-20 min-h-440",children:[jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,mode:"wait",children:jsxRuntimeExports.jsx(TemplateGrid,{query:n})}),n.items.length&&jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:n})]})]})}function TemplateGrid({query:{items:e,isLoading:s,isReloading:t,noResults:o}}){return e.length?jsxRuntimeExports.jsx(TemplateGridLayout,{animationKey:"templates",children:e.map(n=>jsxRuntimeExports.jsx(TemplateGridItemLayout,{label:n.name.replace(/-/g," "),className:"group",children:jsxRuntimeExports.jsxs("div",{className:"relative cursor-pointer",children:[jsxRuntimeExports.jsx("img",{className:"aspect-[365/228] w-full object-cover",src:n.thumbnail,alt:""}),jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 hidden flex-col items-center justify-center gap-16 bg-white/90 group-hover:flex",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",color:"primary",className:"min-w-124",elementType:Link,to:n.name,children:jsxRuntimeExports.jsx(Trans,{message:"View"})}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",className:"min-w-124",children:jsxRuntimeExports.jsx(Trans,{message:"Select"})}),jsxRuntimeExports.jsx(NewProjectDialog,{templateName:n.name})]},n.name)]})]})},n.name))}):s&&!t?jsxRuntimeExports.jsx(TemplateGridLayout,{animationKey:"skeletons",children:jsxRuntimeExports.jsx(TemplateGridSkeletons,{})}):o?jsxRuntimeExports.jsx(IllustratedMessage,{className:"my-80",size:"sm",title:jsxRuntimeExports.jsx(Trans,{message:"No matching templates"}),description:jsxRuntimeExports.jsx(Trans,{message:"Try another search query or category"}),image:jsxRuntimeExports.jsx(SvgImage,{src:builderImage})}):jsxRuntimeExports.jsx(PageErrorMessage,{})}function useUpdateDomain(){return useMutation({mutationFn:e=>updateDomain(e),onSuccess:(e,s)=>queryClient.invalidateQueries({queryKey:DatatableDataQueryKey("custom-domain")}),onError:e=>showHttpErrorToast(e)})}function updateDomain(e){return apiClient.put(`custom-domain/${e.domainId}`,e).then(s=>s.data)}function CustomDomainsPage(){return jsxRuntimeExports.jsxs("div",{className:"flex h-screen flex-col",children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Branded domains"})}),jsxRuntimeExports.jsx(DashboardNavbar,{}),jsxRuntimeExports.jsxs("div",{className:"container mx-auto mt-40 flex-auto px-20",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-14",children:[jsxRuntimeExports.jsx("h1",{className:"mr-auto text-3xl font-medium",children:jsxRuntimeExports.jsx(Trans,{message:"Branded domains"})}),jsxRuntimeExports.jsx(DashboardWorkspaceSelector,{})]}),jsxRuntimeExports.jsx("p",{className:"text-muted",children:jsxRuntimeExports.jsx(Trans,{message:"Connect and manage your own custom domains."})})]}),jsxRuntimeExports.jsx(Content,{})]}),jsxRuntimeExports.jsx(Footer,{className:"px-40"})]})}function Content(){var n;const{user:e}=useAuth(),{workspaceId:s}=useActiveWorkspaceId(),t=useCustomDomains({userId:e.id,perPage:40,with:"resource.user",workspaceId:s}),o=((n=t.data)==null?void 0:n.pagination.data.length)===0;return jsxRuntimeExports.jsxs("div",{className:"mt-20 flex-auto",children:[jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:i=>{i&&reloadAccountUsage()},children:[jsxRuntimeExports.jsx(Button,{variant:"outline",color:"primary",startIcon:jsxRuntimeExports.jsx(AddIcon,{}),size:"xs",children:jsxRuntimeExports.jsx(Trans,{message:"Connect domain"})}),jsxRuntimeExports.jsx(ConnectDomainDialog,{})]}),jsxRuntimeExports.jsxs("div",{className:"mt-34",children:[o&&jsxRuntimeExports.jsx(NoDomainsMessage,{}),t.data?jsxRuntimeExports.jsx(DomainList,{domains:t.data.pagination.data}):jsxRuntimeExports.jsx(PageStatus,{query:t,loaderIsScreen:!1})]})]})}function DomainList({domains:e}){return jsxRuntimeExports.jsx("div",{children:e.map(s=>{var t;return jsxRuntimeExports.jsxs("div",{className:"rounded-panel border p-16",children:[jsxRuntimeExports.jsx("div",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap font-bold",children:removeProtocol(s.host)}),jsxRuntimeExports.jsx("div",{className:"mb-20 text-sm text-muted",children:s.resource?jsxRuntimeExports.jsxs("div",{className:"mt-4 flex items-center gap-8",children:[jsxRuntimeExports.jsx("img",{className:"h-24 w-24 rounded object-cover",src:getProjectImageUrl(s.resource),alt:""}),jsxRuntimeExports.jsx("div",{children:(t=s.resource)==null?void 0:t.name})]}):jsxRuntimeExports.jsx(Trans,{message:"This domain is not connected to any project yet."})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-10",children:[jsxRuntimeExports.jsx(ProjectSelectorButton,{domain:s}),jsxRuntimeExports.jsx(RemoveDomainButton,{domain:s})]})]},s.id)})})}function ProjectSelectorButton({domain:e}){var a;const{trans:s}=useTrans(),{user:t}=useAuth(),{items:o}=useProjects({userId:t.id,published:"true"}),n=useUpdateDomain(),i=x=>{var l;const u=(l=o.find(c=>c.id===x))==null?void 0:l.name;x&&toast.positive(s(message("Connected “:domain” to  “:name”",{values:{domain:removeProtocol(e.host),name:u}})))};return jsxRuntimeExports.jsxs(MenuTrigger,{selectionMode:"single",selectedValue:((a=e.resource)==null?void 0:a.id)??"",onItemSelected:x=>{n.mutate({domainId:e.id,resource_id:x||null,resource_type:x?"project":null},{onSuccess:()=>i(x)})},children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"xs",endIcon:jsxRuntimeExports.jsx(KeyboardArrowDownIcon,{}),disabled:n.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Change project"})}),jsxRuntimeExports.jsxs(Menu,{children:[jsxRuntimeExports.jsx(Item,{value:"",children:jsxRuntimeExports.jsx(Trans,{message:"No project"})}),o.map(x=>jsxRuntimeExports.jsx(Item,{value:x.id,startIcon:jsxRuntimeExports.jsx("img",{className:"h-24 w-24 object-cover",src:getProjectImageUrl(x),alt:""}),children:x.name},x.id))]})]})}function RemoveDomainButton({domain:e}){const s=useDeleteDomain();return jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"xs",color:"danger",children:jsxRuntimeExports.jsx(Trans,{message:"Remove"})}),jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,isLoading:s.isPending,title:jsxRuntimeExports.jsx(Trans,{message:"Remove domain?"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to remove this domain?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Remove"}),onConfirm:()=>{s.mutate({domain:e},{onSuccess:()=>reloadAccountUsage()})}})]})}function NoDomainsMessage(){return jsxRuntimeExports.jsx(IllustratedMessage,{title:jsxRuntimeExports.jsx(Trans,{message:"No domains"}),description:jsxRuntimeExports.jsx(Trans,{message:"You have not connected any domains yet"}),image:jsxRuntimeExports.jsx(SvgImage,{src:world})})}function TemplatePreviewPage(){const{base_url:e}=useSettings(),{name:s}=useParams(),[t,o]=reactExports.useState("desktop"),{data:n}=useTemplate(s);return jsxRuntimeExports.jsxs("div",{className:"flex h-screen w-screen flex-col",children:[jsxRuntimeExports.jsx(Header,{selectedBreakpoint:t,onBreakpointChange:o,template:n==null?void 0:n.template}),jsxRuntimeExports.jsx("div",{className:clsx("flex flex-auto items-center justify-center",t==="mobile"&&"my-40"),children:n!=null&&n.template?jsxRuntimeExports.jsx("iframe",{className:clsx("transition-size",t==="mobile"?"h-[844px] w-[390px] overflow-hidden rounded-[64px] border-[12px] border-[#444546] shadow-lg":"h-full w-full"),src:`${e}/templates/preview/${n.template.name}`}):jsxRuntimeExports.jsx(FullPageLoader,{})})]})}function Header({selectedBreakpoint:e,onBreakpointChange:s,template:t}){return jsxRuntimeExports.jsxs("header",{className:"flex min-w-0 items-center gap-12 overflow-hidden bg px-12 py-16 shadow-[0,2px,18px,0,rgba(129,162,182,.2)] md:px-32",children:[jsxRuntimeExports.jsx(Logo,{color:"bg",logoColor:"dark",className:"max-md:hidden"}),jsxRuntimeExports.jsx(Button,{startIcon:jsxRuntimeExports.jsx(KeyboardBackspaceIcon,{}),elementType:Link,to:"/dashboard/templates",children:jsxRuntimeExports.jsx(Trans,{message:"Back to templates"})}),jsxRuntimeExports.jsx(IconButton,{className:"ml-auto max-md:hidden",color:e==="mobile"?"primary":void 0,onClick:()=>s("mobile"),children:jsxRuntimeExports.jsx(PhoneIphoneIcon,{})}),jsxRuntimeExports.jsx(IconButton,{className:"max-md:hidden",color:e==="desktop"?"primary":void 0,onClick:()=>s("desktop"),children:jsxRuntimeExports.jsx(DesktopMacIcon,{})}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",className:"ml-auto",disabled:!t,children:jsxRuntimeExports.jsx(Trans,{message:"Use this template"})}),jsxRuntimeExports.jsx(NewProjectDialog,{templateName:t==null?void 0:t.name})]})]})}function DashboardRoutes(){return useRoutes([{path:"",element:jsxRuntimeExports.jsx(ActiveWorkspaceProvider,{children:jsxRuntimeExports.jsx(Outlet,{})}),children:[{path:"/",element:jsxRuntimeExports.jsx(DashboardPage,{})},{path:"/domains",element:jsxRuntimeExports.jsx(CustomDomainsPage,{})},{path:"/templates",element:jsxRuntimeExports.jsx(NewProjectPage,{})},{path:"/templates/:name",element:jsxRuntimeExports.jsx(TemplatePreviewPage,{})},{path:"*",element:jsxRuntimeExports.jsx(NotFoundPage,{})}]}])}export{DashboardRoutes as default};
//# sourceMappingURL=dashboard-routes-2fe01263.js.map
