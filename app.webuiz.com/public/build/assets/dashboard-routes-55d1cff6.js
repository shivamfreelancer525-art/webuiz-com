import{u as useActiveWorkspaceId,r as reactExports,j as jsxRuntimeExports,c as clsx,B as Button,T as Trans,A as AnimatePresence,m,o as opacityAnimation,P as ProgressCircle,a as useTrans,b as useMutation,q as queryClient,t as toast,d as message,s as showHttpErrorToast,e as apiClient,f as useSettings,N as Navbar,L as Link,W as WorkspaceQueryKeys,g as onFormQueryError,h as useForm,i as useDialogContext,D as Dialog,k as DialogHeader,l as DialogBody,F as Form,n as FormTextField,p as DialogFooter,v as useQuery,w as useAuth,x as PersonalWorkspace,C as ConfirmationDialog,y as useValueLists,z as DialogTrigger,I as IconButton,E as ExitToAppIcon,G as CloseIcon,M as MenuTrigger,H as ArrowDropDownIcon,J as Menu,K as Item,O as ButtonBase,U as UnfoldMoreIcon,Q as useUserWorkspaces,R as useActiveWorkspace,S as openDialog,V as CheckIcon,X as KeyboardArrowDownIcon,Y as Skeleton,$ as $62d8ded9296f3872$export$cfa2225e87938781,Z as lazyLoader,_ as dot,a0 as StaticPageTitle,a1 as TextField,a2 as SearchIcon,a3 as Footer,a4 as FormattedRelativeTime,a5 as IllustratedMessage,a6 as SvgImage,a7 as useNavigate,a8 as SelectForwardRef,a9 as PageErrorMessage,aa as LinkStyle,ab as PageStatus,ac as useParams,ad as FullPageLoader,ae as Logo,af as useRoutes,ag as ActiveWorkspaceProvider,ah as Outlet,ai as NotFoundPage}from"./main-8005bc2f.js";import{u as useInfiniteData,b as builderImage,M as MoreVertIcon,a as useCreateProject,c as useTemplates,d as useDeleteDomain,w as world,e as useTemplate}from"./use-delete-domain-57c5492c.js";import{r as reloadAccountUsage,C as ChipField,A as AddIcon,D as DeleteIcon,u as useAccountUsage,g as getProjectImageUrl,K as KeyboardArrowRightIcon,a as getProjectPreviewUrl,P as ProjectLink,b as DatatableDataQueryKey,c as ConnectDomainDialog,d as removeProtocol}from"./blank-page-skeleton-219aa08c.js";import{P as PolicyFailMessage,a as ProjectSettingsDialog,u as useCustomDomains}from"./project-settings-dialog-de2c4c66.js";import{G as GroupIcon,P as PersonAddIcon,K as KeyboardBackspaceIcon}from"./KeyboardBackspace-d149cec8.js";import{E as EditIcon}from"./Edit-3620caf2.js";import{P as PhoneIphoneIcon,D as DesktopMacIcon}from"./DesktopMac-55dbf3b5.js";import"./info-dialog-trigger-593096c8.js";function useProjects(e){const{workspaceId:s}=useActiveWorkspaceId();return useInfiniteData({queryKey:["projects",{...e,workspaceId:s}],endpoint:"projects",paginate:e.paginate||"simple",defaultOrderBy:"updated_at",defaultOrderDir:"desc",queryParams:{...e,workspaceId:s},willSortOrFilter:!0})}function InfiniteScrollSentinel({query:{isInitialLoading:e,fetchNextPage:s,isFetchingNextPage:t,hasNextPage:n},children:o,loaderMarginTop:a="mt-24",style:i,className:x,variant:u="infiniteScroll",loadMoreExtraContent:c,size:l="md"}){const d=reactExports.useRef(null),p=t||e,[R,h]=reactExports.useState(0),E=u==="loadMore"&&R<3?"loadMore":"infiniteScroll";reactExports.useEffect(()=>{const g=d.current;if(!g||E==="loadMore")return;const f=new IntersectionObserver(([v])=>{v.isIntersecting&&n&&!p&&s()});return f.observe(g),()=>{f.unobserve(g)}},[s,n,p,E]);let j;return o?j=t?o:null:E==="loadMore"?j=!e&&n&&jsxRuntimeExports.jsxs("div",{className:clsx("flex items-center gap-8",a),children:[c,jsxRuntimeExports.jsx(Button,{size:l==="md"?"sm":"xs",className:clsx(l==="sm"?"min-h-24 min-w-96":"min-h-36 min-w-112"),variant:"outline",color:"primary",onClick:()=>{s(),h(R+1)},disabled:p,children:R>=2&&!t?jsxRuntimeExports.jsx(Trans,{message:"Load all"}):jsxRuntimeExports.jsx(Trans,{message:"Show more"})})]}):j=jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsx(m.div,{className:clsx("flex w-full justify-center",a),...opacityAnimation,children:jsxRuntimeExports.jsx(ProgressCircle,{size:l,isIndeterminate:!0,"aria-label":"loading"})})}),jsxRuntimeExports.jsxs("div",{style:i,className:clsx("w-full",x,n&&"min-h-36"),role:"presentation",children:[jsxRuntimeExports.jsx("div",{ref:d,"aria-hidden":!0}),j]})}function useDeleteProject(){const{trans:e}=useTrans();return useMutation({mutationFn:s=>deleteProject(s),onSuccess:async()=>{reloadAccountUsage(),await queryClient.invalidateQueries({queryKey:["projects"]}),toast(e(message("Project deleted")))},onError:s=>showHttpErrorToast(s)})}async function deleteProject({projectId:e}){return apiClient.delete(`projects/${e}`).then(s=>s.data)}function DashboardNavbar(){const{billing:e}=useSettings();return jsxRuntimeExports.jsx(Navbar,{menuPosition:"dashboard",className:"flex-shrink-0",rightChildren:e.enable?jsxRuntimeExports.jsx(Button,{variant:"outline",size:"xs",color:"primary",elementType:Link,to:"/pricing",children:jsxRuntimeExports.jsx(Trans,{message:"Upgrade"})}):void 0})}function useCreateWorkspace(e){return useMutation({mutationFn:s=>createWorkspace(s),onSuccess:()=>{toast(message("Created workspace")),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.fetchUserWorkspaces})},onError:s=>onFormQueryError(s,e)})}function createWorkspace(e){return apiClient.post("workspace",e).then(s=>s.data)}function NewWorkspaceDialog(){const e=useForm(),{formId:s,close:t}=useDialogContext(),n=useCreateWorkspace(e);return jsxRuntimeExports.jsxs(Dialog,{children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Create workspace"})}),jsxRuntimeExports.jsx(DialogBody,{children:jsxRuntimeExports.jsx(Form,{form:e,id:s,onSubmit:()=>{n.mutate(e.getValues(),{onSuccess:o=>{t(o.workspace.id)}})},children:jsxRuntimeExports.jsx(FormTextField,{name:"name",autoFocus:!0,label:jsxRuntimeExports.jsx(Trans,{message:"Workspace name"}),minLength:3,required:!0})})}),jsxRuntimeExports.jsxs(DialogFooter,{children:[jsxRuntimeExports.jsx(Button,{variant:"text",onClick:t,children:jsxRuntimeExports.jsx(Trans,{message:"Cancel"})}),jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",type:"submit",form:s,disabled:n.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Create"})})]})]})}function fetchWorkspaceWithMembers(e){return apiClient.get(`workspace/${e}`).then(s=>s.data)}function useWorkspaceWithMembers(e){return useQuery({queryKey:WorkspaceQueryKeys.workspaceWithMembers(e),queryFn:()=>fetchWorkspaceWithMembers(e)})}function InviteMembers({workspaceId:e,...s}){return apiClient.post(`workspace/${e}/invite`,s).then(t=>t.data)}function useInviteMembers(){return useMutation({mutationFn:e=>InviteMembers(e),onSuccess:(e,s)=>{queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(s.workspaceId)})},onError:e=>showHttpErrorToast(e)})}function ResendInvite({workspaceId:e,inviteId:s,...t}){return apiClient.post(`workspace/${e}/${s}/resend`,t).then(n=>n.data)}function useResendInvite(){return useMutation({mutationFn:e=>ResendInvite(e),onSuccess:()=>{toast("Invite sent")},onError:e=>showHttpErrorToast(e)})}const matcher=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function isEmail(e){return!e||e.length>320?!1:matcher.test(e)}function ChangeRole({workspaceId:e,member:s,...t}){const n=s.model_type,o=s.model_type==="invite"?s.id:s.member_id;return apiClient.post(`workspace/${e}/${n}/${o}/change-role`,t).then(a=>a.data)}function useChangeRole(){return useMutation({mutationFn:e=>ChangeRole(e),onSuccess:(e,s)=>{toast(message("Role changed")),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(s.workspaceId)})},onError:e=>showHttpErrorToast(e)})}function removeMember({workspaceId:e,memberId:s,memberType:t}){const n=t==="invite"?`workspace/invite/${s}`:`workspace/${e}/member/${s}`;return apiClient.delete(n).then(o=>o.data)}function useRemoveMember(){const{workspaceId:e,setWorkspaceId:s}=useActiveWorkspaceId(),{user:t}=useAuth();return useMutation({mutationFn:n=>removeMember(n),onSuccess:(n,o)=>{queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.fetchUserWorkspaces}),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(o.workspaceId)}),o.memberId===(t==null?void 0:t.id)&&e===o.workspaceId&&s(PersonalWorkspace.id)},onError:n=>showHttpErrorToast(n)})}function LeaveWorkspaceConfirmation({onConfirm:e,isLoading:s}){return jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Leave workspace"}),isLoading:s,onConfirm:e,body:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to leave this workspace?"}),jsxRuntimeExports.jsx("div",{className:"mt-8 font-semibold",children:jsxRuntimeExports.jsx(Trans,{message:"All resources you've created in the workspace will be transferred to workspace owner."})})]}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Leave"})})}function WorkspaceMembersDialog({workspace:e}){const{data:s,isLoading:t}=useWorkspaceWithMembers(e.id);return jsxRuntimeExports.jsxs(Dialog,{size:"lg",children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Manage workspace members"})}),jsxRuntimeExports.jsx(DialogBody,{children:t?jsxRuntimeExports.jsx("div",{className:"flex min-h-[238px] items-center justify-center",children:jsxRuntimeExports.jsx(ProgressCircle,{isIndeterminate:!0,"aria-label":"Loading workspace..."})}):jsxRuntimeExports.jsx(Manager,{workspace:s.workspace})})]})}function Manager({workspace:e}){const{user:s}=useAuth(),t=usePermissions(e),n=[...e.members||[],...e.invites||[]],o=!t.update&&!t.delete;return jsxRuntimeExports.jsxs("div",{children:[t.invite&&jsxRuntimeExports.jsx(InviteChipField,{workspace:e}),jsxRuntimeExports.jsxs("div",{className:"mb-14 flex items-center gap-10 text-base",children:[jsxRuntimeExports.jsx(GroupIcon,{className:"icon-sm"}),jsxRuntimeExports.jsx(Trans,{message:"Members of `:workspace`",values:{workspace:e.name}})]}),jsxRuntimeExports.jsxs(AnimatePresence,{initial:!1,children:[n.map(a=>o&&a.id!==(s==null?void 0:s.id)?null:jsxRuntimeExports.jsx(MemberListItem,{workspace:e,member:a},`${a.model_type}.${a.id}`)),o&&jsxRuntimeExports.jsx("div",{className:"text-muted",children:jsxRuntimeExports.jsx(Trans,{message:"And [one one other member|:count other members]",values:{count:n.length}})})]})]})}function MemberListItem({workspace:e,member:s}){return jsxRuntimeExports.jsxs(m.div,{initial:{x:"-100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"100%",opacity:0},transition:{type:"tween",duration:.125},className:"mb-20 flex items-start gap-14 text-sm",children:[jsxRuntimeExports.jsx("img",{className:"h-36 w-36 flex-shrink-0 rounded",src:s.avatar,alt:""}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-auto items-center justify-between gap-14 md:flex",children:[jsxRuntimeExports.jsxs("div",{className:"mb-10 overflow-hidden md:mb-0 md:mr-10",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-start gap-6",children:[jsxRuntimeExports.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:s.display_name}),jsxRuntimeExports.jsx(MemberDisplayNameAppend,{workspace:e,member:s})]}),jsxRuntimeExports.jsx("div",{className:"text-muted",children:s.email})]}),jsxRuntimeExports.jsx(MemberActions,{workspace:e,member:s})]})]},`${s.model_type}.${s.id}`)}function usePermissions(e){var a;const{user:s}=useAuth(),t={update:!1,invite:!1,delete:!1},n=["update","invite","delete"],o=(a=e.members)==null?void 0:a.find(i=>i.id===(s==null?void 0:s.id));return o&&n.forEach(i=>{var x;t[i]=o.is_owner||!!((x=o.permissions)!=null&&x.find(u=>u.name===`workspace_members.${i}`))}),t}function MemberActions({workspace:e,member:s}){const[t,n]=reactExports.useState(s.role_id),o=useChangeRole(),{user:a}=useAuth(),i=usePermissions(e),x=s.model_type==="member"&&s.is_owner,u=s.model_type==="member"&&(a==null?void 0:a.id)===s.id,c=!i.update||x||u?jsxRuntimeExports.jsx("div",{className:"ml-auto text-muted first:capitalize",children:jsxRuntimeExports.jsx(Trans,{message:s.role_name})}):jsxRuntimeExports.jsx(RoleMenuTrigger,{className:"ml-auto flex-shrink-0",size:"xs",value:t,isDisabled:o.isPending,onChange:l=>{n(l),o.mutate({roleId:l,workspaceId:e.id,member:s})}});return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[c,!x&&(u||i.delete)&&jsxRuntimeExports.jsx(RemoveMemberButton,{type:u?"leave":"remove",member:s,workspace:e})]})}function InviteChipField({workspace:e}){const{trans:s}=useTrans(),[t,n]=reactExports.useState([]),o=t.every(l=>!l.invalid),a=l=>l.description||l.name,[i,x]=reactExports.useState(),u=useInviteMembers(),{data:c}=useValueLists(["workspaceRoles"]);return reactExports.useEffect(()=>{var l;!i&&((l=c==null?void 0:c.workspaceRoles)!=null&&l.length)&&x(c.workspaceRoles[0].id)},[c,i]),jsxRuntimeExports.jsxs("div",{className:"mb-30",children:[jsxRuntimeExports.jsx(ChipField,{value:t,onChange:n,displayWith:a,validateWith:l=>{const d=!isEmail(l.description);return{...l,invalid:d,errorMessage:d?s({message:"Not a valid email"}):void 0}},placeholder:s({message:"Enter email addresses"}),label:jsxRuntimeExports.jsx(Trans,{message:"Invite people"})}),jsxRuntimeExports.jsxs("div",{className:"mt-14 flex items-center justify-between gap-14",children:[jsxRuntimeExports.jsx(RoleMenuTrigger,{onChange:x,value:i}),t.length&&i?jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",size:"sm",disabled:u.isPending||!o,onClick:()=>{u.mutate({emails:t.map(l=>a(l)),roleId:i,workspaceId:e.id},{onSuccess:()=>{n([])}})},children:jsxRuntimeExports.jsx(Trans,{message:"Invite"})}):null]})]})}function RemoveMemberButton({member:e,workspace:s,type:t}){const n=useRemoveMember(),{close:o}=useDialogContext();return jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:a=>{a&&(n.mutate({workspaceId:s.id,memberId:e.id,memberType:e.model_type}),t==="leave"&&(o(),toast(message("Left workspace"))))},children:[jsxRuntimeExports.jsx(IconButton,{size:"md",className:"flex-shrink-0 text-muted",disabled:n.isPending,children:t==="leave"?jsxRuntimeExports.jsx(ExitToAppIcon,{}):jsxRuntimeExports.jsx(CloseIcon,{})}),t==="leave"?jsxRuntimeExports.jsx(LeaveWorkspaceConfirmation,{}):jsxRuntimeExports.jsx(RemoveMemberConfirmation,{member:e})]})}function RemoveMemberConfirmation({member:e}){return jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Remove member"}),body:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to remove `:name`?",values:{name:e.display_name}}),jsxRuntimeExports.jsx("div",{className:"mt-8 font-semibold",children:jsxRuntimeExports.jsx(Trans,{message:"All workspace resources created by `:name` will be transferred to workspace owner.",values:{name:e.display_name}})})]}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Remove"})})}function RoleMenuTrigger({value:e,onChange:s,size:t="xs",className:n,isDisabled:o}){var x;const{data:a}=useValueLists(["workspaceRoles"]),i=(x=a==null?void 0:a.workspaceRoles)==null?void 0:x.find(u=>u.id===e);return!e||!i||!(a!=null&&a.workspaceRoles)?null:jsxRuntimeExports.jsxs(MenuTrigger,{selectionMode:"single",selectedValue:e,onSelectionChange:u=>{s(u)},children:[jsxRuntimeExports.jsx(Button,{className:n,size:t,variant:"flat",color:"chip",disabled:o,endIcon:jsxRuntimeExports.jsx(ArrowDropDownIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:i.name})}),jsxRuntimeExports.jsx(Menu,{children:a.workspaceRoles.map(u=>jsxRuntimeExports.jsx(Item,{value:u.id,description:u.description,children:jsxRuntimeExports.jsx(Trans,{message:u.name})},u.id))})]})}function MemberDisplayNameAppend({member:e,workspace:s}){const{user:t}=useAuth(),n=usePermissions(s);return(t==null?void 0:t.id)===e.id?jsxRuntimeExports.jsxs("div",{className:"font-medium",children:["(",jsxRuntimeExports.jsx(Trans,{message:"You"}),")"]}):e.model_type==="invite"?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("div",{children:"·"}),jsxRuntimeExports.jsx("div",{className:"font-medium",children:jsxRuntimeExports.jsx(Trans,{message:"Invited"})}),n.invite?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:"·"}),jsxRuntimeExports.jsx(ResendInviteDialogTrigger,{member:e,workspace:s})]}):null]}):null}function ResendInviteDialogTrigger({member:e,workspace:s}){const t=useResendInvite();return jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:n=>{n&&t.mutate({workspaceId:s.id,inviteId:e.id})},children:[jsxRuntimeExports.jsx(Button,{variant:"link",size:"sm",color:"primary",disabled:t.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Resend invite"})}),jsxRuntimeExports.jsx(ConfirmationDialog,{title:jsxRuntimeExports.jsx(Trans,{message:"Resend invite"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to send this invite again?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Send"})})]})}function updateWorkspace({id:e,...s}){return apiClient.put(`workspace/${e}`,s).then(t=>t.data)}function useUpdateWorkspace(e){const{close:s}=useDialogContext();return useMutation({mutationFn:t=>updateWorkspace(t),onSuccess:t=>{s(),toast(message("Updated workspace")),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.fetchUserWorkspaces}),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(t.workspace.id)})},onError:t=>onFormQueryError(t,e)})}function RenameWorkspaceDialog({workspace:e}){const s=useForm({defaultValues:{id:e.id,name:e.name}}),{formId:t,close:n}=useDialogContext(),o=useUpdateWorkspace(s);return jsxRuntimeExports.jsxs(Dialog,{children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Rename workspace"})}),jsxRuntimeExports.jsx(DialogBody,{children:jsxRuntimeExports.jsx(Form,{form:s,id:t,onSubmit:()=>{o.mutate(s.getValues())},children:jsxRuntimeExports.jsx(FormTextField,{name:"name",autoFocus:!0,label:jsxRuntimeExports.jsx(Trans,{message:"Name"}),minLength:3,required:!0})})}),jsxRuntimeExports.jsxs(DialogFooter,{children:[jsxRuntimeExports.jsx(Button,{variant:"text",onClick:n,children:jsxRuntimeExports.jsx(Trans,{message:"Cancel"})}),jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",type:"submit",form:t,disabled:o.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Rename"})})]})]})}function deleteWorkspace({id:e}){return apiClient.delete(`workspace/${e}`).then(s=>s.data)}function useDeleteWorkspace(){const{workspaceId:e,setWorkspaceId:s}=useActiveWorkspaceId();return useMutation({mutationFn:t=>deleteWorkspace(t),onSuccess:(t,n)=>{toast(message("Deleted workspace")),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.fetchUserWorkspaces}),queryClient.invalidateQueries({queryKey:WorkspaceQueryKeys.workspaceWithMembers(n.id)}),e===n.id&&s(PersonalWorkspace.id)},onError:t=>showHttpErrorToast(t)})}function WorkspaceSelector({onChange:e,className:s,trigger:t,placement:n="top"}){const{data:o,isFetched:a,isFetching:i}=useUserWorkspaces(),{setWorkspaceId:x}=useActiveWorkspaceId(),u=useActiveWorkspace(),[c,l]=reactExports.useState(!1),{hasPermission:d}=useAuth();return reactExports.useEffect(()=>{a&&!i&&!u&&x(PersonalWorkspace.id)},[u,o,x,a,i]),!t&&(!u||!d("workspaces.create")&&(o==null?void 0:o.length)===1)?null:jsxRuntimeExports.jsx(reactExports.Fragment,{children:jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",placement:n,isOpen:c,onClose:()=>{l(!1)},children:[t?reactExports.cloneElement(t,{onClick:()=>l(!c)}):jsxRuntimeExports.jsx(DefaultTrigger,{onClick:()=>l(!c),workspace:u,className:s}),jsxRuntimeExports.jsx(Dialog,{size:"min-w-320",children:jsxRuntimeExports.jsxs(DialogBody,{padding:"p-10",children:[jsxRuntimeExports.jsx("div",{className:"mb-16 border-b pb-10",children:o==null?void 0:o.map(p=>jsxRuntimeExports.jsx(WorkspaceItem,{workspace:p,setSelectorIsOpen:l,onChange:e},p.id))}),jsxRuntimeExports.jsx("div",{className:"mb-4 px-4 text-center",children:jsxRuntimeExports.jsx(CreateWorkspaceButton,{onClick:()=>l(!1),onCreated:p=>e==null?void 0:e(p),workspaceCount:o?o.length-1:0})})]})})]})})}function CreateWorkspaceButton({onClick:e,onCreated:s,workspaceCount:t}){const{setWorkspaceId:n}=useActiveWorkspaceId(),{checkOverQuotaOrNoPermission:o}=useAuth(),{overQuotaOrNoPermission:a}=o("workspaces.create","count",t);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{disabled:a,onClick:async i=>{i.preventDefault(),i.stopPropagation(),e();const x=await openDialog(NewWorkspaceDialog);x&&(n(x),s==null||s(x))},variant:"outline",startIcon:jsxRuntimeExports.jsx(AddIcon,{}),color:"primary",className:"h-40 w-full",children:jsxRuntimeExports.jsx(Trans,{message:"Create new workspace"})}),a&&jsxRuntimeExports.jsx(PolicyFailMessage,{size:"sm",className:"mt-12 max-w-288",resourceName:jsxRuntimeExports.jsx(Trans,{message:"worksapces"})})]})}const DefaultTrigger=reactExports.forwardRef(({workspace:e,className:s,onClick:t,...n},o)=>jsxRuntimeExports.jsxs(ButtonBase,{ref:o,onClick:t,className:clsx("flex items-center gap-10 rounded ring-inset hover:bg-hover focus-visible:ring-2",s),...n,children:[jsxRuntimeExports.jsxs("span",{className:"mr-auto block flex-auto overflow-hidden text-left",children:[jsxRuntimeExports.jsx("span",{className:"block overflow-hidden overflow-ellipsis text-sm font-medium text-main",children:e.default?jsxRuntimeExports.jsx(Trans,{message:e.name}):e.name}),jsxRuntimeExports.jsx("span",{className:"block text-xs text-muted",children:e.default?jsxRuntimeExports.jsx(Trans,{message:"Personal workspace"}):jsxRuntimeExports.jsx(Trans,{message:":count members",values:{count:e.members_count}})})]}),jsxRuntimeExports.jsx(UnfoldMoreIcon,{className:"shrink-0 icon-md"})]}));function WorkspaceItem({workspace:e,onChange:s,setSelectorIsOpen:t}){const{workspaceId:n,setWorkspaceId:o}=useActiveWorkspaceId(),a=n===e.id;return jsxRuntimeExports.jsxs("div",{onClick:()=>{o(e.id),s==null||s(e.id),t(!1)},className:clsx("mb-4 flex cursor-pointer items-center gap-12 rounded-lg p-10 text-left",a&&"bg-primary/5",!a&&"hover:bg-hover"),children:[jsxRuntimeExports.jsx(CheckIcon,{size:"sm",className:clsx("flex-shrink-0 text-primary",!a&&"invisible")}),jsxRuntimeExports.jsxs("div",{className:"flex-auto",children:[jsxRuntimeExports.jsx("div",{className:clsx("text-sm",a&&"font-semibold"),children:e.name}),jsxRuntimeExports.jsx("div",{className:"text-sm text-muted",children:e.default?jsxRuntimeExports.jsx(Trans,{message:"Personal workspace"}):jsxRuntimeExports.jsx(Trans,{message:":count members",values:{count:e.members_count}})})]}),e.id!==0&&jsxRuntimeExports.jsx(ManageButton,{setSelectorIsOpen:t,workspace:e,onChange:s})]})}function LeaveWorkspaceDialog({workspace:e,onChange:s}){const t=useRemoveMember(),{user:n}=useAuth(),{close:o}=useDialogContext();return jsxRuntimeExports.jsx(LeaveWorkspaceConfirmation,{isLoading:t.isPending,onConfirm:()=>{t.mutate({workspaceId:e.id,memberId:n.id,memberType:"member"},{onSuccess:()=>{o(),s==null||s(PersonalWorkspace.id)}})}})}function DeleteWorkspaceConfirmation({workspace:e,onChange:s}){const t=useDeleteWorkspace(),{close:n}=useDialogContext();return jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Delete workspace"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to delete “:name“?",values:{name:e.name}}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Delete"}),isLoading:t.isPending,onConfirm:()=>{t.mutate({id:e.id},{onSuccess:()=>{n(),s==null||s(PersonalWorkspace.id)}})}})}function ManageButton({setSelectorIsOpen:e,workspace:s,onChange:t}){const{user:n}=useAuth();return jsxRuntimeExports.jsxs(MenuTrigger,{onItemSelected:()=>e(!1),children:[jsxRuntimeExports.jsx(Button,{onClick:o=>{o.preventDefault(),o.stopPropagation()},color:"primary",size:"xs",variant:"outline",endIcon:jsxRuntimeExports.jsx(KeyboardArrowDownIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Manage"})}),jsxRuntimeExports.jsxs(Menu,{children:[jsxRuntimeExports.jsx(Item,{onClick:o=>{o.stopPropagation(),openDialog(WorkspaceMembersDialog,{workspace:s})},value:"workspaceMembers",startIcon:jsxRuntimeExports.jsx(PersonAddIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Members"})}),s.owner_id===(n==null?void 0:n.id)&&jsxRuntimeExports.jsx(Item,{onClick:o=>{o.stopPropagation(),openDialog(RenameWorkspaceDialog,{workspace:s})},value:"updateWorkspace",startIcon:jsxRuntimeExports.jsx(EditIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Rename"})}),s.owner_id!==(n==null?void 0:n.id)&&jsxRuntimeExports.jsx(Item,{onClick:o=>{o.stopPropagation(),openDialog(LeaveWorkspaceDialog,{workspace:s,onChange:t})},value:"leaveWorkspace",startIcon:jsxRuntimeExports.jsx(ExitToAppIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Leave"})}),s.owner_id===(n==null?void 0:n.id)&&jsxRuntimeExports.jsx(Item,{onClick:o=>{o.stopPropagation(),openDialog(DeleteWorkspaceConfirmation,{workspace:s,onChange:t})},value:"deleteWorkspace",startIcon:jsxRuntimeExports.jsx(DeleteIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"Delete"})})]})]})}function DashboardWorkspaceSelector({className:e}){const s=useActiveWorkspace();return jsxRuntimeExports.jsx("div",{className:e,children:jsxRuntimeExports.jsx(WorkspaceSelector,{onChange:()=>reloadAccountUsage(),placement:"bottom",trigger:jsxRuntimeExports.jsx(Button,{variant:"outline",className:"min-w-[188px]",justify:"justify-between",endIcon:jsxRuntimeExports.jsx(UnfoldMoreIcon,{}),children:jsxRuntimeExports.jsx(Label,{workspace:s})})})})}function Label({workspace:e}){return e?e.default?jsxRuntimeExports.jsx(Trans,{message:"Default workspace"}):e.name:jsxRuntimeExports.jsx(Skeleton,{})}function AdHost({slot:e,className:s}){var a;const t=useSettings(),{isSubscribed:n}=useAuth(),o=reactExports.useMemo(()=>dot.pick(`ads.${e}`,t),[e,t]);return(a=t.ads)!=null&&a.disable||n||!o?null:jsxRuntimeExports.jsx(InvariantAd,{className:s,slot:e,adCode:o})}const InvariantAd=reactExports.memo(({slot:e,adCode:s,className:t})=>{const n=reactExports.useRef(null),o=reactExports.useId();return reactExports.useEffect(()=>(n.current&&loadAdScripts(s,n.current).then(()=>{executeAdJavascript(s,o)}),()=>{delete window.google_ad_modifications}),[s,o]),reactExports.useEffect(()=>{if(n.current){const a=$62d8ded9296f3872$export$cfa2225e87938781(n.current);if(a){const i=new MutationObserver(function(){a.style.height="",a.style.minHeight=""});return i.observe(a,{attributes:!0,attributeFilter:["style"]}),()=>i.disconnect()}}},[]),jsxRuntimeExports.jsx("div",{ref:n,id:o,className:clsx("ad-host flex max-h-[600px] min-h-90 w-full max-w-full items-center justify-center overflow-hidden",`${e.replace(/\./g,"-")}-host`,t),dangerouslySetInnerHTML:{__html:getAdHtml(s)}})},()=>!1);function getAdHtml(e){return e==null?void 0:e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").trim()}function loadAdScripts(e,s){const t=[],n=/<script.*?src=['"](.*?)['"]/g;let o;for(;o=n.exec(e);)o[1]&&t.push(lazyLoader.loadAsset(o[1],{type:"js",parentEl:s}));return Promise.all(t)}function executeAdJavascript(adCode,id){const pattern=/<script\b[^>]*>([\s\S]*?)<\/script>/g;let content;for(;content=pattern.exec(adCode);)if(content[1]){const r=`var d = document.createElement('div'); d.innerHTML = $1; document.getElementById('${id}').appendChild(d.firstChild);`,toEval=content[1].replace(/document.write\((.+?)\);/,r);eval(toEval)}}const SortOptions=[{value:"created_at|desc",label:message("Date created")},{value:"name|asc",label:message("Alphabetical")},{value:"updated_at|desc",label:message("Last updated")}];function DashboardPage(){const{data:e}=useAccountUsage(),{trans:s}=useTrans(),{user:t}=useAuth(),n=useProjects({userId:t.id,paginate:"lengthAware"}),{sortDescriptor:o,setSortDescriptor:a,searchQuery:i,setSearchQuery:x}=n,u=`${o.orderBy}|${o.orderDir}`;return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Dashboard"})}),jsxRuntimeExports.jsxs("div",{className:"flex h-screen flex-col overflow-y-scroll",children:[jsxRuntimeExports.jsx(DashboardNavbar,{}),jsxRuntimeExports.jsxs("div",{className:"container mx-auto flex-auto px-12",children:[(e==null?void 0:e.projects.create.allowed)===!1&&jsxRuntimeExports.jsx(PolicyFailMessage,{className:"mt-24 text-center",resourceName:jsxRuntimeExports.jsx(Trans,{message:"sites"})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-12 py-36",children:[jsxRuntimeExports.jsx(DashboardWorkspaceSelector,{className:"mr-auto"}),jsxRuntimeExports.jsx(TextField,{size:"sm",placeholder:s(message("Search sites...")),startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),value:i,onChange:c=>x(c.target.value)}),jsxRuntimeExports.jsxs(MenuTrigger,{selectionMode:"single",selectedValue:u,onItemSelected:c=>{const[l,d]=c.split("|");a({orderBy:l,orderDir:d})},children:[jsxRuntimeExports.jsx(Button,{size:"sm",variant:"outline",endIcon:jsxRuntimeExports.jsx(KeyboardArrowDownIcon,{}),children:jsxRuntimeExports.jsx(Trans,{...SortOptions.find(c=>c.value===u).label})}),jsxRuntimeExports.jsx(Menu,{children:SortOptions.map(c=>jsxRuntimeExports.jsx(Item,{value:c.value,children:jsxRuntimeExports.jsx(Trans,{...c.label})},c.value))})]}),jsxRuntimeExports.jsx(Button,{size:"sm",variant:"flat",color:"primary",elementType:Link,to:"templates",startIcon:jsxRuntimeExports.jsx(AddIcon,{}),disabled:!(e!=null&&e.projects.create.allowed),children:jsxRuntimeExports.jsx(Trans,{message:"New site"})})]}),jsxRuntimeExports.jsx(AdHost,{slot:"dashboard_top",className:"mb-36"}),jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,mode:"wait",children:jsxRuntimeExports.jsx(ProjectGrid,{query:n})}),jsxRuntimeExports.jsx(AdHost,{slot:"dashboard_bottom",className:"mt-36"})]}),jsxRuntimeExports.jsx(Footer,{className:"mt-40 px-40"})]})]})}function ProjectGrid({query:e}){return e.data?e.noResults?jsxRuntimeExports.jsx(NoProjectsMessage,{isSearching:!!e.searchQuery}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(GridLayout,{animationKey:"projects",children:e.items.map(s=>jsxRuntimeExports.jsxs("div",{className:"rounded-panel border shadow",children:[jsxRuntimeExports.jsxs("div",{className:"group relative",children:[jsxRuntimeExports.jsx("img",{className:"aspect-video w-full",src:getProjectImageUrl(s),alt:""}),jsxRuntimeExports.jsx("div",{className:"absolute left-0 top-0 hidden h-full w-full items-center justify-center bg-white/70 group-hover:flex",children:jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",endIcon:jsxRuntimeExports.jsx(KeyboardArrowRightIcon,{}),elementType:Link,to:`/editor/${s.id}`,children:jsxRuntimeExports.jsx(Trans,{message:"Open editor"})})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-6 p-20",children:[jsxRuntimeExports.jsxs("div",{className:"flex-auto",children:[jsxRuntimeExports.jsx("button",{type:"button",onClick:t=>{console.log("Project name clicked:",s.name),t.stopPropagation(),t.preventDefault();const n=getProjectPreviewUrl(s);console.log("Original URL:",n);const o=n.startsWith("http://")||n.startsWith("https://")?n:`${window.location.origin}${n.startsWith("/")?n:"/"+n}`;console.log("Absolute URL:",o);const a=window.open(o,"_blank","noopener,noreferrer");console.log("Window opened:",a),a||(console.warn("Popup blocked. Please allow popups for this site."),alert("Popup blocked! Please allow popups for this site or use Ctrl+Click to open in new tab."))},onMouseDown:t=>{t.stopPropagation()},className:"font-bold hover:text-primary transition-colors cursor-pointer text-left bg-transparent border-0 p-0 m-0 w-auto h-auto block",title:`Open ${s.name} in new tab`,children:s.name}),jsxRuntimeExports.jsx("div",{className:"text-sm text-muted",children:jsxRuntimeExports.jsx(ProjectLink,{project:s,target:"_blank"})}),jsxRuntimeExports.jsx("div",{className:"mt-4 text-xs text-muted",children:jsxRuntimeExports.jsx(FormattedRelativeTime,{date:s.updated_at})})]}),jsxRuntimeExports.jsx(OptionsTrigger,{project:s})]})]},s.id))}),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:e})]}):e.isLoading?jsxRuntimeExports.jsx(GridLayout,{animationKey:"skeletons",children:[...Array(6)].map((s,t)=>jsxRuntimeExports.jsx(Skeleton,{variant:"rect",size:"h-[310px]"},t))}):null}function GridLayout({children:e,animationKey:s}){return jsxRuntimeExports.jsx(m.div,{...opacityAnimation,className:"grid grid-cols-1 gap-12 md:grid-cols-3",children:e},s)}function NoProjectsMessage({isSearching:e}){return jsxRuntimeExports.jsx(IllustratedMessage,{className:"mt-40",title:jsxRuntimeExports.jsx(Trans,{message:"No sites"}),description:e?jsxRuntimeExports.jsx(Trans,{message:"No sites match your search query"}):jsxRuntimeExports.jsx(Trans,{message:"You have not created any sites yet"}),image:jsxRuntimeExports.jsx(SvgImage,{src:builderImage})})}function OptionsTrigger({project:e}){const[s,t]=reactExports.useState(!1);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsxs(MenuTrigger,{children:[jsxRuntimeExports.jsx(IconButton,{className:"text-muted",children:jsxRuntimeExports.jsx(MoreVertIcon,{})}),jsxRuntimeExports.jsxs(Menu,{children:[jsxRuntimeExports.jsx(Item,{value:"edit",elementType:Link,to:`/editor/${e.id}`,children:jsxRuntimeExports.jsx(Trans,{message:"Edit"})}),jsxRuntimeExports.jsx(Item,{value:"preview",elementType:Link,target:"_blank",to:getProjectPreviewUrl(e),children:jsxRuntimeExports.jsx(Trans,{message:"Preview"})}),jsxRuntimeExports.jsx(Item,{value:"settings",onSelected:()=>openDialog(ProjectSettingsDialog,{project:e}),children:jsxRuntimeExports.jsx(Trans,{message:"Settings"})}),jsxRuntimeExports.jsx(Item,{value:"delete",onSelected:()=>t(!0),children:jsxRuntimeExports.jsx(Trans,{message:"Delete"})})]})]}),jsxRuntimeExports.jsx(DeleteProjectDialog,{isOpen:s,onClose:()=>t(!1),projectId:e.id})]})}function DeleteProjectDialog({projectId:e,isOpen:s,onClose:t}){const n=useDeleteProject();return jsxRuntimeExports.jsx(DialogTrigger,{type:"modal",isOpen:s,onClose:t,children:jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Delete project"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to delete this project?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Delete"}),isLoading:n.isPending,onConfirm:()=>{n.mutate({projectId:e},{onSuccess:()=>{t()}})}})})}function TemplateGridLayout({className:e,children:s,animationKey:t}){return jsxRuntimeExports.jsx(m.div,{className:clsx("grid grid-cols-1 gap-20 md:grid-cols-3",e),...opacityAnimation,children:s},t)}const TemplateGridItemLayout=reactExports.forwardRef(({children:e,label:s,className:t},n)=>jsxRuntimeExports.jsxs("div",{ref:n,className:clsx("overflow-hidden rounded-panel border border-transparent shadow-md",t),children:[e,jsxRuntimeExports.jsx("div",{className:"mt-4 flex items-center justify-center p-12 text-sm font-semibold capitalize",children:s})]}));function TemplateGridSkeletons(){return jsxRuntimeExports.jsx(reactExports.Fragment,{children:[...Array(9)].map((e,s)=>jsxRuntimeExports.jsx(TemplateGridItemLayout,{label:jsxRuntimeExports.jsx(Skeleton,{}),children:jsxRuntimeExports.jsx(Skeleton,{variant:"rect",size:"aspect-[365/228]"})},s))})}function NewProjectDialog({templateName:e}){const{formId:s,close:t}=useDialogContext(),n=useNavigate(),o=useForm({defaultValues:{templateName:e}}),a=useCreateProject(o);return jsxRuntimeExports.jsxs(Dialog,{children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Create new site"})}),jsxRuntimeExports.jsx(DialogBody,{children:jsxRuntimeExports.jsx(Form,{form:o,id:s,onSubmit:i=>a.mutate(i,{onSuccess:x=>{t(),n(`/editor/${x.project.model.id}`,{replace:!0})}}),children:jsxRuntimeExports.jsx(FormTextField,{name:"name",label:jsxRuntimeExports.jsx(Trans,{message:"Name"}),autoFocus:!0,required:!0})})}),jsxRuntimeExports.jsxs(DialogFooter,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>t(),children:jsxRuntimeExports.jsx(Trans,{message:"Cancel"})}),jsxRuntimeExports.jsx(Button,{form:s,type:"submit",variant:"flat",color:"primary",disabled:a.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Create"})})]})]})}function NewProjectPage(){return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"New site"})}),jsxRuntimeExports.jsx(DashboardNavbar,{}),jsxRuntimeExports.jsxs("div",{className:"container mx-auto mt-40 px-20",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-medium",children:jsxRuntimeExports.jsx(Trans,{message:"Choose a template for your project"})}),jsxRuntimeExports.jsx("p",{className:"mt-2 text-muted",children:jsxRuntimeExports.jsx(Trans,{message:"All templates are 100% customizable so choose one then make it your own."})})]}),jsxRuntimeExports.jsx(TemplateForm,{}),jsxRuntimeExports.jsx(Footer,{})]})]})}function TemplateForm(){var a;const{trans:e}=useTrans(),{builder:s}=useSettings(),[t,n]=reactExports.useState(""),o=useTemplates({category:t,perPage:24});return jsxRuntimeExports.jsxs("div",{className:"mt-20 md:mt-40",children:[jsxRuntimeExports.jsxs("section",{className:"items-center justify-between gap-12 md:flex",children:[jsxRuntimeExports.jsxs("div",{className:"flex-auto items-center gap-12 md:flex",children:[jsxRuntimeExports.jsx(TextField,{placeholder:e(message("Search...")),startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),className:"min-w-288 max-md:mb-12",value:o.searchQuery,onChange:i=>o.setSearchQuery(i.target.value),endAdornment:o.isReloading&&o.searchQuery&&jsxRuntimeExports.jsx(ProgressCircle,{isIndeterminate:!0,size:"xs"})}),jsxRuntimeExports.jsxs(SelectForwardRef,{selectionMode:"single",name:"category",className:"min-w-288 max-md:mb-12",floatingWidth:"matchTrigger",selectedValue:t,onItemSelected:i=>n(i),children:[jsxRuntimeExports.jsx(Item,{value:"",children:jsxRuntimeExports.jsx(Trans,{message:"All categories"})}),(a=s==null?void 0:s.template_categories)==null?void 0:a.map(i=>jsxRuntimeExports.jsx(Item,{value:i,children:jsxRuntimeExports.jsx(Trans,{message:i})},i))]})]}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",className:"min-h-42",children:jsxRuntimeExports.jsx(Trans,{message:"Start with blank page"})}),jsxRuntimeExports.jsx(NewProjectDialog,{})]})]}),jsxRuntimeExports.jsxs("div",{className:"my-20 min-h-440",children:[jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,mode:"wait",children:jsxRuntimeExports.jsx(TemplateGrid,{query:o})}),o.items.length&&jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:o})]})]})}function TemplateGrid({query:{items:e,isLoading:s,isReloading:t,noResults:n}}){return e.length?jsxRuntimeExports.jsx(TemplateGridLayout,{animationKey:"templates",children:e.map(o=>jsxRuntimeExports.jsx(TemplateGridItemLayout,{label:o.name.replace(/-/g," "),className:"group",children:jsxRuntimeExports.jsxs("div",{className:"relative cursor-pointer",children:[jsxRuntimeExports.jsx("img",{className:"aspect-[365/228] w-full object-cover",src:o.thumbnail,alt:""}),jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 hidden flex-col items-center justify-center gap-16 bg-white/90 group-hover:flex",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",color:"primary",className:"min-w-124",elementType:Link,to:o.name,children:jsxRuntimeExports.jsx(Trans,{message:"View"})}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",className:"min-w-124",children:jsxRuntimeExports.jsx(Trans,{message:"Select"})}),jsxRuntimeExports.jsx(NewProjectDialog,{templateName:o.name})]},o.name)]})]})},o.name))}):s&&!t?jsxRuntimeExports.jsx(TemplateGridLayout,{animationKey:"skeletons",children:jsxRuntimeExports.jsx(TemplateGridSkeletons,{})}):n?jsxRuntimeExports.jsx(IllustratedMessage,{className:"my-80",size:"sm",title:jsxRuntimeExports.jsx(Trans,{message:"No matching templates"}),description:jsxRuntimeExports.jsx(Trans,{message:"Try another search query or category"}),image:jsxRuntimeExports.jsx(SvgImage,{src:builderImage})}):jsxRuntimeExports.jsx(PageErrorMessage,{})}function useUpdateDomain(){return useMutation({mutationFn:e=>updateDomain(e),onSuccess:(e,s)=>queryClient.invalidateQueries({queryKey:DatatableDataQueryKey("custom-domain")}),onError:e=>showHttpErrorToast(e)})}function updateDomain(e){return apiClient.put(`custom-domain/${e.domainId}`,e).then(s=>s.data)}function CustomDomainsPage(){return jsxRuntimeExports.jsxs("div",{className:"flex h-screen flex-col",children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Branded domains"})}),jsxRuntimeExports.jsx(DashboardNavbar,{}),jsxRuntimeExports.jsxs("div",{className:"container mx-auto mt-40 flex-auto px-20",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-14",children:[jsxRuntimeExports.jsx("h1",{className:"mr-auto text-3xl font-medium",children:jsxRuntimeExports.jsx(Trans,{message:"Branded domains"})}),jsxRuntimeExports.jsx(DashboardWorkspaceSelector,{})]}),jsxRuntimeExports.jsx("p",{className:"text-muted",children:jsxRuntimeExports.jsx(Trans,{message:"Connect and manage your own custom domains."})})]}),jsxRuntimeExports.jsx(Content,{})]}),jsxRuntimeExports.jsx(Footer,{className:"px-40"})]})}function Content(){var E,j;const{user:e,getRestrictionValue:s}=useAuth(),{workspaceId:t}=useActiveWorkspaceId(),{data:n}=useAccountUsage(),o=useCustomDomains({userId:e.id,perPage:40,with:"resource.user",workspaceId:t}),a=((E=o.data)==null?void 0:E.pagination.data.length)===0,i=s("projects.create","count"),x=((j=o.data)==null?void 0:j.pagination.data.length)??(n==null?void 0:n.custom_domains.used)??0,u=n?n.custom_domains.create.allowed!==!1:!0,c=i==null||x<i,l=u&&c,d=i!=null&&typeof i=="number"&&x>=i,p=n&&n.custom_domains.create.allowed===!1,R=o.data!==void 0||n!==void 0,h=d&&R||p&&n;return jsxRuntimeExports.jsxs("div",{className:"mt-20 flex-auto",children:[jsxRuntimeExports.jsx("div",{className:"mb-20",children:jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:g=>{g&&reloadAccountUsage()},children:[jsxRuntimeExports.jsx(Button,{variant:"outline",color:"primary",startIcon:jsxRuntimeExports.jsx(AddIcon,{}),size:"xs",disabled:!l,children:jsxRuntimeExports.jsx(Trans,{message:"Connect domain"})}),jsxRuntimeExports.jsx(ConnectDomainDialog,{})]})}),h&&jsxRuntimeExports.jsx(PolicyFailMessage,{className:"mb-20",size:"sm",resourceName:jsxRuntimeExports.jsx(Trans,{message:"custom domains"}),reason:d?"overQuota":n==null?void 0:n.custom_domains.create.failReason,message:d&&i!==null&&i!==void 0?jsxRuntimeExports.jsx(Trans,{message:"You have reached the maximum number of custom domains allowed for your plan. Your plan allows :count website(s), so you can add up to :domainCount custom domain(s). <a>Please upgrade your plan to add more custom domains.</a>",values:{count:i,domainCount:i,a:g=>jsxRuntimeExports.jsx(Link,{className:LinkStyle,to:"/pricing",children:g})}}):void 0}),jsxRuntimeExports.jsxs("div",{className:"mt-34",children:[a&&jsxRuntimeExports.jsx(NoDomainsMessage,{}),o.data?jsxRuntimeExports.jsx(DomainList,{domains:o.data.pagination.data}):jsxRuntimeExports.jsx(PageStatus,{query:o,loaderIsScreen:!1})]})]})}function DomainList({domains:e}){return jsxRuntimeExports.jsx("div",{children:e.map(s=>{var t;return jsxRuntimeExports.jsxs("div",{className:"rounded-panel border p-16",children:[jsxRuntimeExports.jsx("div",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap font-bold",children:removeProtocol(s.host)}),jsxRuntimeExports.jsx("div",{className:"mb-20 text-sm text-muted",children:s.resource?jsxRuntimeExports.jsxs("div",{className:"mt-4 flex items-center gap-8",children:[jsxRuntimeExports.jsx("img",{className:"h-24 w-24 rounded object-cover",src:getProjectImageUrl(s.resource),alt:""}),jsxRuntimeExports.jsx("div",{children:(t=s.resource)==null?void 0:t.name})]}):jsxRuntimeExports.jsx(Trans,{message:"This domain is not connected to any project yet."})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-10",children:[jsxRuntimeExports.jsx(ProjectSelectorButton,{domain:s}),jsxRuntimeExports.jsx(RemoveDomainButton,{domain:s})]})]},s.id)})})}function ProjectSelectorButton({domain:e}){var i;const{trans:s}=useTrans(),{user:t}=useAuth(),{items:n}=useProjects({userId:t.id,published:"true"}),o=useUpdateDomain(),a=x=>{var c;const u=(c=n.find(l=>l.id===x))==null?void 0:c.name;x&&toast.positive(s(message("Connected “:domain” to  “:name”",{values:{domain:removeProtocol(e.host),name:u}})))};return jsxRuntimeExports.jsxs(MenuTrigger,{selectionMode:"single",selectedValue:((i=e.resource)==null?void 0:i.id)??"",onItemSelected:x=>{o.mutate({domainId:e.id,resource_id:x||null,resource_type:x?"project":null},{onSuccess:()=>a(x)})},children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"xs",endIcon:jsxRuntimeExports.jsx(KeyboardArrowDownIcon,{}),disabled:o.isPending,children:jsxRuntimeExports.jsx(Trans,{message:"Change project"})}),jsxRuntimeExports.jsxs(Menu,{children:[jsxRuntimeExports.jsx(Item,{value:"",children:jsxRuntimeExports.jsx(Trans,{message:"No project"})}),n.map(x=>jsxRuntimeExports.jsx(Item,{value:x.id,startIcon:jsxRuntimeExports.jsx("img",{className:"h-24 w-24 object-cover",src:getProjectImageUrl(x),alt:""}),children:x.name},x.id))]})]})}function RemoveDomainButton({domain:e}){const s=useDeleteDomain();return jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"xs",color:"danger",children:jsxRuntimeExports.jsx(Trans,{message:"Remove"})}),jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,isLoading:s.isPending,title:jsxRuntimeExports.jsx(Trans,{message:"Remove domain?"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to remove this domain?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Remove"}),onConfirm:()=>{s.mutate({domain:e},{onSuccess:()=>reloadAccountUsage()})}})]})}function NoDomainsMessage(){return jsxRuntimeExports.jsx(IllustratedMessage,{title:jsxRuntimeExports.jsx(Trans,{message:"No domains"}),description:jsxRuntimeExports.jsx(Trans,{message:"You have not connected any domains yet"}),image:jsxRuntimeExports.jsx(SvgImage,{src:world})})}function TemplatePreviewPage(){const{base_url:e}=useSettings(),{name:s}=useParams(),[t,n]=reactExports.useState("desktop"),{data:o}=useTemplate(s);return jsxRuntimeExports.jsxs("div",{className:"flex h-screen w-screen flex-col",children:[jsxRuntimeExports.jsx(Header,{selectedBreakpoint:t,onBreakpointChange:n,template:o==null?void 0:o.template}),jsxRuntimeExports.jsx("div",{className:clsx("flex flex-auto items-center justify-center",t==="mobile"&&"my-40"),children:o!=null&&o.template?jsxRuntimeExports.jsx("iframe",{className:clsx("transition-size",t==="mobile"?"h-[844px] w-[390px] overflow-hidden rounded-[64px] border-[12px] border-[#444546] shadow-lg":"h-full w-full"),src:`${e}/templates/preview/${o.template.name}`}):jsxRuntimeExports.jsx(FullPageLoader,{})})]})}function Header({selectedBreakpoint:e,onBreakpointChange:s,template:t}){return jsxRuntimeExports.jsxs("header",{className:"flex min-w-0 items-center gap-12 overflow-hidden bg px-12 py-16 shadow-[0,2px,18px,0,rgba(129,162,182,.2)] md:px-32",children:[jsxRuntimeExports.jsx(Logo,{color:"bg",logoColor:"dark",className:"max-md:hidden"}),jsxRuntimeExports.jsx(Button,{startIcon:jsxRuntimeExports.jsx(KeyboardBackspaceIcon,{}),elementType:Link,to:"/dashboard/templates",children:jsxRuntimeExports.jsx(Trans,{message:"Back to templates"})}),jsxRuntimeExports.jsx(IconButton,{className:"ml-auto max-md:hidden",color:e==="mobile"?"primary":void 0,onClick:()=>s("mobile"),children:jsxRuntimeExports.jsx(PhoneIphoneIcon,{})}),jsxRuntimeExports.jsx(IconButton,{className:"max-md:hidden",color:e==="desktop"?"primary":void 0,onClick:()=>s("desktop"),children:jsxRuntimeExports.jsx(DesktopMacIcon,{})}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",className:"ml-auto",disabled:!t,children:jsxRuntimeExports.jsx(Trans,{message:"Use this template"})}),jsxRuntimeExports.jsx(NewProjectDialog,{templateName:t==null?void 0:t.name})]})]})}function DashboardRoutes(){return useRoutes([{path:"",element:jsxRuntimeExports.jsx(ActiveWorkspaceProvider,{children:jsxRuntimeExports.jsx(Outlet,{})}),children:[{path:"/",element:jsxRuntimeExports.jsx(DashboardPage,{})},{path:"/domains",element:jsxRuntimeExports.jsx(CustomDomainsPage,{})},{path:"/templates",element:jsxRuntimeExports.jsx(NewProjectPage,{})},{path:"/templates/:name",element:jsxRuntimeExports.jsx(TemplatePreviewPage,{})},{path:"*",element:jsxRuntimeExports.jsx(NotFoundPage,{})}]}])}export{DashboardRoutes as default};
//# sourceMappingURL=dashboard-routes-55d1cff6.js.map
